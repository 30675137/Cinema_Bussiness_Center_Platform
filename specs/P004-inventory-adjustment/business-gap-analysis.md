# 产品上架售卖最小业务闭环功能缺口分析

> **文档版本**: 1.0  
> **创建日期**: 2025-12-27  
> **分析依据**: 零售行业解决方案白皮书、当前系统功能现状

---

## 1. 业务闭环定义

### 1.1 完整业务流程路径

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        产品上架售卖最小业务闭环                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ①商品创建        ②库存准备        ③上架售卖        ④订单处理        ⑤履约完成  │
│  ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐│
│  │ SPU创建  │────▶│ 采购入库 │────▶│ 价格设置 │────▶│ 订单创建 │────▶│ 出品确认 ││
│  │ SKU创建  │     │ 库存初始化│     │ 渠道上架 │     │ 库存预占 │     │ 库存扣减 ││
│  │ BOM配置  │     │ 安全库存 │     │ 可售状态 │     │ 支付完成 │     │ 订单完成 ││
│  └─────────┘     └─────────┘     └─────────┘     └─────────┘     └─────────┘│
│       ✅              🟡              🔴              🔴              🔴      │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

图例：✅ 已完成  🟡 部分实现  🔴 缺失/待开发
```

### 1.2 核心业务场景

| 场景 | 流程描述 | 涉及模块 |
|------|---------|---------|
| **即时商品售卖** | 顾客在小程序下单 → 支付 → 吧台出品 → 取餐 | 订单、支付、出品、库存 |
| **场景包预约** | 选择场景包 → 选时段 → 预约支付 → 到店消费 | 场景包、预约、支付、履约 |
| **现调饮品售卖** | 下单饮品 → BOM扣料 → 调制出品 → 交付 | 订单、BOM、库存、出品 |

---

## 2. 当前系统能力现状

### 2.1 模块完成度统计

| 系统模块 | 完成度 | 关键缺口 |
|---------|:-----:|---------|
| 商品管理 (MDM/PIM) | 77% | SKU价格体系待完善 |
| BOM/配方管理 | 53% | BOM版本管理、成本核算待开发 |
| **库存管理 (IMS)** | **21%** | ⚠️ 严重不足：预占、调拨、盘点待开发 |
| 场景包/套餐管理 | 84% | 基本完成 |
| **采购与供应链** | **31%** | 订单审批、采购计划待开发 |
| **订单与履约** | **31%** | ⚠️ 严重不足：支付、出品待开发 |
| 门店与资源管理 | 58% | 基本可用 |
| **运营报表** | **0%** | ⚠️ 完全缺失 |
| 系统管理 | 39% | 权限管理待完善 |
| C端小程序 | 73% | 微信支付待对接 |

### 2.2 已实现的核心能力

| 能力 | 状态 | 说明 |
|------|:----:|------|
| SPU/SKU 主数据管理 | ✅ | 完整CRUD，支持四类型SKU |
| 类目/品牌/属性管理 | ✅ | 完整的主数据体系 |
| 库存台账查询 | ✅ | 多维筛选、状态预警 |
| 库存调整 | ✅ | 盘盈/盘亏/报损，支持审批 |
| 场景包配置 | ✅ | 完整的场景包管理 |
| 预约订单管理 | ✅ | 基础预约流程 |
| 小程序下单流程 | ✅ | 选购到下单（未支付） |
| 供应商管理 | ✅ | 完整CRUD |

---

## 3. 功能缺口分析

### 3.1 P0 级缺口（阻塞性 - 无法完成交易闭环）

#### 3.1.1 微信支付对接

| 维度 | 说明 |
|------|------|
| **缺失功能** | 微信支付发起、支付回调、支付状态同步 |
| **业务影响** | 🚫 无法完成线上交易，订单无法真正成交 |
| **实现必要性** | C端小程序核心变现能力，无支付=无收入 |
| **依赖关系** | 无前置依赖，但被订单状态流转、出品管理依赖 |
| **预估工作量** | 3-5人天（含微信商户对接） |

#### 3.1.2 库存预占机制

| 维度 | 说明 |
|------|------|
| **缺失功能** | 订单预占、预占释放、超时自动释放、防超卖 |
| **业务影响** | 🚫 可能出现超卖，库存数据不准确 |
| **实现必要性** | 保障库存准确性，避免客户下单后无货的尴尬 |
| **依赖关系** | 依赖库存台账基础，被订单创建依赖 |
| **预估工作量** | 3-4人天 |

#### 3.1.3 订单状态流转

| 维度 | 说明 |
|------|------|
| **缺失功能** | 待支付→已支付→待出品→已完成→已取消的完整状态机 |
| **业务影响** | 🚫 无法追踪订单全生命周期，运营无法管理 |
| **实现必要性** | 订单管理的基础能力，运营必需 |
| **依赖关系** | 依赖支付回调，被出品管理依赖 |
| **预估工作量** | 2-3人天 |

---

### 3.2 P1 级缺口（核心体验 - 影响运营效率）

#### 3.2.1 吧台出品管理

| 维度 | 说明 |
|------|------|
| **缺失功能** | 吧台工作台、出品确认、出品记录、BOM自动扣料 |
| **业务影响** | ⚠️ 吧台无系统支撑，人工对单易出错 |
| **实现必要性** | 提升出品效率，实现自动化库存扣减 |
| **依赖关系** | 依赖订单状态、BOM配方 |
| **预估工作量** | 5-7人天 |

#### 3.2.2 BOM自动扣料

| 维度 | 说明 |
|------|------|
| **缺失功能** | 出品时按BOM配方自动扣减原料/包材库存 |
| **业务影响** | ⚠️ 现调饮品库存不准，原料库存无法联动 |
| **实现必要性** | 现调饮品场景必需，成本核算基础 |
| **依赖关系** | 依赖BOM配方数据、库存更新接口 |
| **预估工作量** | 3-4人天 |

#### 3.2.3 价格体系管理

| 维度 | 说明 |
|------|------|
| **缺失功能** | SKU定价策略、门店差异化定价、价格生效规则 |
| **业务影响** | ⚠️ 价格修改不灵活，无法支持多门店差异定价 |
| **实现必要性** | 连锁经营的基础能力 |
| **依赖关系** | 依赖SKU主数据 |
| **预估工作量** | 4-5人天 |

#### 3.2.4 退款处理

| 维度 | 说明 |
|------|------|
| **缺失功能** | 退款申请、退款审批、微信退款、库存释放 |
| **业务影响** | ⚠️ 无法处理客户退款，售后体验差 |
| **实现必要性** | 交易闭环的逆向流程，客服必需 |
| **依赖关系** | 依赖支付对接、订单状态 |
| **预估工作量** | 3-4人天 |

---

### 3.3 P2 级缺口（运营增强 - 提升管理效率）

#### 3.3.1 采购订单审批

| 维度 | 说明 |
|------|------|
| **缺失功能** | 采购单审批流程、审批权限配置 |
| **业务影响** | 采购无审批管控，风险敞口 |
| **依赖关系** | 依赖权限管理 |
| **预估工作量** | 2-3人天 |

#### 3.3.2 库存调拨

| 维度 | 说明 |
|------|------|
| **缺失功能** | 调拨申请、调拨审批、在途追踪、收货确认 |
| **业务影响** | 多门店间无法灵活调配库存 |
| **依赖关系** | 依赖库存台账、审批流程 |
| **预估工作量** | 5-7人天 |

#### 3.3.3 销售报表

| 维度 | 说明 |
|------|------|
| **缺失功能** | 日销报表、商品销量排行、门店业绩对比 |
| **业务影响** | 运营决策缺乏数据支撑 |
| **依赖关系** | 依赖订单数据 |
| **预估工作量** | 5-7人天 |

#### 3.3.4 权限管理

| 维度 | 说明 |
|------|------|
| **缺失功能** | 角色管理、权限配置、数据权限 |
| **业务影响** | 无法精细控制操作权限 |
| **依赖关系** | 被所有业务模块依赖 |
| **预估工作量** | 5-7人天 |

---

## 4. 功能依赖关系图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              功能依赖关系                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  基础层（已完成）                                                            │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐                        │
│  │SPU/SKU  │  │库存台账  │  │BOM配方  │  │场景包   │                        │
│  │主数据   │  │         │  │         │  │         │                        │
│  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘                        │
│       │            │            │            │                              │
│       └────────────┼────────────┼────────────┘                              │
│                    │            │                                           │
│  ┌─────────────────▼────────────▼─────────────────┐                        │
│  │               P0: 交易核心层                    │                        │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐        │                        │
│  │  │微信支付  │─▶│订单状态  │─▶│库存预占  │        │                        │
│  │  │(P0)     │  │流转(P0) │  │(P0)     │        │                        │
│  │  └─────────┘  └────┬────┘  └─────────┘        │                        │
│  └────────────────────┼──────────────────────────┘                        │
│                       │                                                     │
│  ┌────────────────────▼──────────────────────────┐                        │
│  │               P1: 履约执行层                   │                        │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐        │                        │
│  │  │吧台出品  │─▶│BOM扣料  │  │退款处理  │        │                        │
│  │  │(P1)     │  │(P1)     │  │(P1)     │        │                        │
│  │  └─────────┘  └─────────┘  └─────────┘        │                        │
│  │  ┌─────────┐                                  │                        │
│  │  │价格体系  │                                  │                        │
│  │  │(P1)     │                                  │                        │
│  │  └─────────┘                                  │                        │
│  └───────────────────────────────────────────────┘                        │
│                       │                                                     │
│  ┌────────────────────▼──────────────────────────┐                        │
│  │               P2: 运营支撑层                   │                        │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐        │                        │
│  │  │采购审批  │  │库存调拨  │  │销售报表  │        │                        │
│  │  │(P2)     │  │(P2)     │  │(P2)     │        │                        │
│  │  └─────────┘  └─────────┘  └─────────┘        │                        │
│  │  ┌─────────┐                                  │                        │
│  │  │权限管理  │                                  │                        │
│  │  │(P2)     │                                  │                        │
│  │  └─────────┘                                  │                        │
│  └───────────────────────────────────────────────┘                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 优先级排序与实施建议

### 5.1 MVP 最小可行闭环

实现**基础商品售卖**场景，需要完成以下功能：

| 优先级 | 功能 | 工作量 | 累计天数 | 里程碑 |
|:------:|------|:------:|:--------:|--------|
| P0-1 | 微信支付对接 | 5天 | 5天 | 支付能力打通 |
| P0-2 | 订单状态流转 | 3天 | 8天 | 订单生命周期完整 |
| P0-3 | 库存预占机制 | 4天 | 12天 | **MVP 达成** ✅ |

**MVP 达成后可支持**：
- ✅ 顾客下单 → 支付 → 订单完成
- ✅ 库存自动预占，防止超卖
- ✅ 基础订单查询和管理

### 5.2 Phase 1 完整售卖闭环

| 优先级 | 功能 | 工作量 | 累计天数 |
|:------:|------|:------:|:--------:|
| P1-1 | 吧台出品管理 | 7天 | 19天 |
| P1-2 | BOM自动扣料 | 4天 | 23天 |
| P1-3 | 退款处理 | 4天 | 27天 |
| P1-4 | 价格体系管理 | 5天 | 32天 |

**Phase 1 达成后可支持**：
- ✅ 完整的现调饮品售卖场景
- ✅ 吧台系统化出品
- ✅ 原料库存自动扣减
- ✅ 退款售后处理

### 5.3 Phase 2 运营能力增强

| 优先级 | 功能 | 工作量 | 累计天数 |
|:------:|------|:------:|:--------:|
| P2-1 | 权限管理 | 7天 | 39天 |
| P2-2 | 销售报表 | 7天 | 46天 |
| P2-3 | 采购审批 | 3天 | 49天 |
| P2-4 | 库存调拨 | 7天 | 56天 |

---

## 6. 总结

### 6.1 核心阻塞点

| 排序 | 功能 | 阻塞原因 | 优先级 |
|:----:|------|---------|:------:|
| 1 | **微信支付** | 无法收款 = 无法变现 | P0 |
| 2 | **库存预占** | 可能超卖 = 客户投诉 | P0 |
| 3 | **订单状态** | 无法管理 = 运营混乱 | P0 |

### 6.2 实施建议

1. **立即启动** P0 功能开发（微信支付、库存预占、订单状态）
2. 预计 **12人天** 可达成 MVP 最小交易闭环
3. P1 功能可并行准备设计，P0 完成后立即启动
4. 建议按 MVP → Phase 1 → Phase 2 分阶段交付

---

## 附录：相关文档

| 文档 | 路径 |
|-----|------|
| 零售行业解决方案白皮书 | `docs/业务需求/零售行业解决方案白皮书.md` |
| 库存台账功能专项说明 | `docs/业务需求/需求专项说明/库存台账功能专项说明.md` |
| 业务需求规约文档 | `docs/业务需求规约文档.md` |
