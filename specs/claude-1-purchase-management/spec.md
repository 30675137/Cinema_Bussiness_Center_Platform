# 采购与入库管理功能规范

## 菜单信息
- **菜单编号**: 7-2
- **菜单名**: 采购与入库管理
- **功能范围**: 采购订单管理、到货验收、收货入库

## 功能概述

为影院商品管理系统提供完整的前端采购与入库管理界面，覆盖从采购订单创建到商品入库的全流程前端交互体验，确保影院商品采购流程的规范化和效率化。

## 用户角色与使用场景

### 主要用户角色（前端界面展示说明）

> **注意**: 当前版本为前端界面设计，不涉及后端权限控制和登录验证。所有角色相关的界面显示仅为UI设计参考，实际功能权限由后端实现。

- **采购管理员界面**: 创建和管理采购订单，跟踪采购进度的完整界面
- **仓库管理员界面**: 执行收货入库操作，确认商品到货的操作界面
- **财务人员界面**: 查看采购成本和入库价值的只读界面
- **门店经理界面**: 查看本门店采购和入库状态的概览界面

### 核心使用场景

#### 场景1: 采购订单创建
用户在采购订单管理界面根据影院商品需求创建采购订单，选择供应商和仓库，添加商品明细，设置采购数量和价格，通过mock数据模拟提交审批或保存草稿的前端交互。

#### 场景2: 到货验收处理
用户在收货入库界面基于采购订单创建收货入库单，核对商品数量和质量，确认实际收货数量，处理部分收货或全部收货情况的前端操作。

#### 场景3: 采购状态跟踪
用户在采购订单列表界面实时查看采购订单状态（草稿、审批中、已审批、部分收货、已收货、已关闭），跟踪采购进度和到货情况。

## 功能范围

### 包含功能
1. **采购订单管理（PO）**
   - 创建、编辑、删除采购订单
   - 采购订单审批流程
   - 采购订单状态管理

2. **到货验收 & 收货入库（GR/GRN）**
   - 基于采购订单的收货入库
   - 部分收货和全部收货处理
   - 收货确认和状态更新

3. **退货入库/退供管理**
   - 不合格商品退货处理
   - 供应商退货单创建和管理

4. **相关列表、详情、创建/编辑表单、操作流转**
   - 各模块的列表查询和筛选
   - 详情页面查看
   - 表单创建和编辑操作

### 前置功能
- 供应商管理系统
- 商品信息管理系统
- 仓库/门店管理系统

### 不包含功能
- 供应商档案管理（在"供应商管理"模块统一处理）
- 财务AP/发票/付款处理（仅展示只读信息）

## 用户场景与测试

> **前端设计重点**: 以下场景专注于前端界面设计和用户交互体验，所有数据操作通过mock数据实现，不涉及后端API集成和权限验证。

### 场景1: 采购订单创建流程
**界面用户**: 采购管理员界面
**前端交互步骤**:
1. 进入采购订单管理页面，展示订单列表
2. 点击"新建采购订单"按钮，打开右侧抽屉或全屏表单
3. 在表单中选择供应商（下拉选择，支持前端搜索过滤）
4. 选择仓库/门店（下拉选择）
5. 设置下单日期和计划到货日期（日期选择器）
6. 在商品明细区域：
   - 通过搜索框选择商品（前端本地搜索mock数据）
   - 输入采购数量（数字输入框，前端验证）
   - 设置采购单价（数字输入框）
   - 配置税率（下拉选择）
7. 前端实时计算小计和合计金额（JavaScript计算逻辑）
8. 选择"保存草稿"或"提交审批"按钮（前端状态管理）
9. 前端显示成功提示和模拟生成的订单号

**预期前端结果**: 成功显示采购订单创建界面，表单验证正常，数据计算准确，界面交互流畅

### 场景2: 收货入库操作
**界面用户**: 仓库管理员界面
**前端交互步骤**:
1. 从采购订单详情页点击"新建收货入库"按钮
2. 前端自动填充采购订单基本信息（只读展示）
3. 前端显示该订单的所有商品明细（mock数据渲染）
4. 用户对每个商品设置"本次收货数量"（输入控件）
5. 前端实时计算"未收数量"和"本次总金额"（JavaScript逻辑）
6. 用户确认收货信息无误
7. 点击"确认入库"按钮
8. 前端更新模拟的采购订单状态为"部分收货"或"已收货"
9. 前端显示收货入库单创建成功的提示

**预期前端结果**: 收货入库表单交互正常，数据验证准确，状态更新模拟正确，用户体验流畅

### 场景3: 采购订单状态跟踪
**界面用户**: 采购管理员界面
**前端交互步骤**:
1. 进入采购订单列表页面，展示分页数据
2. 使用前端筛选条件查询特定状态的订单
3. 查看订单的收货进度条和百分比（前端UI组件）
4. 点击订单进入详情页面
5. 查看关联的收货入库单列表（mock数据）
6. 通过前端界面跟踪整个采购到货流程

**预期前端结果**: 列表页面筛选和排序功能正常，详情页面数据展示完整，进度可视化效果良好

## 功能需求

> **前端设计重点**: 以下需求专注于前端界面设计、用户交互和数据处理逻辑，所有功能通过前端JavaScript和mock数据实现。

### FR-001: 采购订单管理界面
- **FR-001-01**: 前端提供采购订单创建界面，包含供应商、仓库、商品明细等表单组件
- **FR-001-02**: 前端支持采购订单的编辑功能（仅限草稿或审批前状态的前端状态管理）
- **FR-001-03**: 前端支持采购订单多种状态展示：草稿、审批中、已审批、部分收货、已收货、已关闭
- **FR-001-04**: 前端为采购订单生成模拟的唯一订单编号
- **FR-001-05**: 前端支持删除草稿状态采购订单的确认界面

### FR-002: 采购订单商品明细界面
- **FR-002-01**: 前端支持向采购订单添加多行商品明细的表格组件
- **FR-002-02**: 前端支持按SKU编码/商品名称搜索商品（本地mock数据搜索）
- **FR-002-03**: 商品明细表格包含：商品信息、采购数量、单价、税率、小计金额列
- **FR-002-04**: 前端实时计算商品小计和订单合计金额（JavaScript计算逻辑）
- **FR-002-05**: 前端支持删除和修改商品明细行的交互操作

### FR-003: 收货入库管理界面
- **FR-003-01**: 前端提供基于采购订单创建收货入库单的表单界面
- **FR-003-02**: 前端自动关联采购订单的供应商和仓库信息（只读展示组件）
- **FR-003-03**: 前端支持用户设置每种商品的本次收货数量输入控件
- **FR-003-04**: 前端验证本次收货数量不超过未收数量（客户端验证逻辑）
- **FR-003-05**: 前端支持部分收货和全部收货两种模式的界面切换
- **FR-003-06**: 收货确认后前端更新模拟的采购订单状态

### FR-004: 收货状态跟踪界面
- **FR-004-01**: 前端实时显示采购订单的收货进度（已收数量/订购数量）
- **FR-004-02**: 前端提供查看采购订单关联的所有收货入库单的列表界面
- **FR-004-03**: 前端根据收货情况更新模拟的采购订单状态
- **FR-004-04**: 收货进度以进度条和百分比形式在前端可视化展示

### FR-005: 查询与筛选功能
- **FR-005-01**: 采购订单列表支持按订单号、供应商名称的模糊搜索（前端过滤）
- **FR-005-02**: 前端支持多条件筛选：状态、仓库/门店、日期范围
- **FR-005-03**: 收货入库列表支持按收货单号、采购单号、供应商筛选
- **FR-005-04**: 所有列表页面支持前端分页和排序功能

### FR-006: 角色界面说明
- **FR-006-01**: 不同角色界面展示不同的操作按钮（UI设计差异）
- **FR-006-02**: 普通运营界面只显示新建/编辑草稿状态订单的操作按钮
- **FR-006-03**: 仓库界面显示收货确认操作的相关按钮
- **FR-006-04**: 管理员界面显示关闭采购订单、作废收货单的管理按钮
- **FR-006-05**: 当前版本所有角色界面均通过mock数据展示，无实际权限控制

### FR-007: 前端数据校验与错误处理
- **FR-007-01**: 前端必填字段校验（供应商、仓库、商品、数量、单价）
- **FR-007-02**: 前端数值字段校验（数量、单价必须大于0）
- **FR-007-03**: 前端收货数量校验（不超过可收数量）
- **FR-007-04**: 前端提供清晰的错误提示和操作指导信息

### FR-008: 用户体验优化
- **FR-008-01**: 表单页面提供离开前未保存提示（前端路由守卫）
- **FR-008-02**: 前端记住用户上次的筛选条件和分页位置（localStorage）
- **FR-008-03**: 表格支持横向滚动，固定关键列和操作列（CSS样式）
- **FR-008-04**: 状态使用带颜色的Tag组件增强可读性

## 澄清说明

### Session 2025-12-11

- **Q**: 功能范围是否包含后端实现和权限控制？ → **A**: 本版本专注于前端设计，不考虑后端实现，所有操作通过mock数据实现
- **Q**: 不同角色要求如何处理？ → **A**: 角色要求写成界面说明提示，仅用于UI设计参考，当前版本无实际权限控制
- **Q**: 登录和权限验证是否考虑？ → **A**: 暂时不考虑角色和登录问题，全部操作通过mock实现

## 成功标准

### 前端设计量化指标
- **界面响应**: 表单和列表页面加载时间小于2秒
- **交互效率**: 采购订单创建表单填写时间小于5分钟
- **数据展示**: 支持1000+条采购订单数据的流畅展示和筛选
- **UI一致性**: 界面组件使用统一的设计规范，视觉一致性100%
- **用户测试**: 前端界面可用性测试通过率达到95%以上

### 前端质量指标
- **界面完整性**: 100%的采购和收货业务流程都有对应的前端界面
- **数据验证**: 前端表单数据验证覆盖率达到100%
- **错误处理**: 前端错误提示和用户指导清晰度评分4.5/5以上
- **响应式设计**: 支持桌面端、平板端的基础响应式布局
- **无障碍访问**: 基础无障碍功能符合WCAG 2.1 AA标准

### 前端技术指标
- **组件复用**: 核心业务组件复用率达到80%以上
- **代码质量**: 前端代码符合ESLint和Prettier规范
- **性能优化**: 页面首屏渲染时间小于3秒，交互响应时间小于500ms
- **浏览器兼容**: 支持Chrome、Firefox、Safari、Edge等主流浏览器
- **移动端适配**: 移动端基础功能可访问（视项目需求）

## 关键实体

### 采购订单 (Purchase Order)
- **订单号**: 唯一标识符
- **供应商信息**: 供应商ID、名称
- **仓库/门店**: 目标仓库或门店
- **订单日期**: 创建日期
- **计划到货日期**: 预期到货日期
- **订单状态**: 草稿/审批中/已审批/部分收货/已收货/已关闭
- **订单金额**: 含税/不含税金额
- **商品明细**: 商品列表及相关信息
- **创建人**: 订单创建者
- **备注**: 附加说明信息

### 商品明细 (Order Item)
- **商品ID**: 商品唯一标识
- **商品名称**: 商品描述
- **规格型号**: 商品规格
- **单位**: 计量单位
- **订购数量**: 采购数量
- **单价**: 采购单价
- **税率**: 适用税率
- **小计金额**: 行金额
- **已收数量**: 已收货数量
- **未收数量**: 待收货数量

### 收货入库单 (Goods Receipt)
- **收货单号**: 唯一标识符
- **关联采购单**: 对应的采购订单
- **供应商**: 供应商信息
- **仓库/门店**: 收货仓库
- **收货日期**: 实际收货日期
- **收货状态**: 草稿/已入库/作废
- **收货明细**: 商品收货详情
- **经办人**: 收货操作人员
- **总数量**: 收货总数量
- **总金额**: 收货总金额

## 假设条件

### 业务假设
- 供应商信息已在供应商管理模块中维护
- 商品基础信息（SKU、规格、单位）已在商品管理模块中维护
- 仓库/门店信息已配置完成
- 采购审批流程根据业务需要配置，可选择性启用

### 技术假设
- 系统支持中后台标准布局模式
- 前端支持响应式设计，适配不同屏幕尺寸
- 数据库支持事务处理，确保数据一致性
- 系统支持权限配置的动态管理

### 用户假设
- 用户具备基本的计算机操作能力
- 用户熟悉影院商品管理业务流程
- 用户能够理解采购和入库的基本概念

---

**创建日期**: 2025-12-11
**创建人**: 系统
**文档版本**: v1.0
**分支**: claude-1-purchase-management