# US-001 åˆ›å»ºSKUä¸»æ¡£ éªŒè¯æ–‡æ¡£

**ç‰ˆæœ¬**: 1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-12-25  
**çŠ¶æ€**: MVPå®Œæˆ (93.3%)

---

## ğŸ“Œ è®¿é—®é“¾æ¥æ±‡æ€»

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| **å‰ç«¯é¦–é¡µ** | http://localhost:5173 | å½±é™¢ä¸šåŠ¡ä¸­å° |
| **SKUç®¡ç†é¡µé¢** | http://localhost:5173/products/sku | SKUåˆ—è¡¨/æ–°å»º/ç¼–è¾‘/æŸ¥çœ‹ |
| **åç«¯API** | http://localhost:8080 | Spring BootæœåŠ¡ |
| **SKU APIåŸºç¡€è·¯å¾„** | http://localhost:8080/api/skus | RESTfulæ¥å£ |

---

## ğŸš€ å¯åŠ¨æ­¥éª¤

### 1. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd /Users/lining/qoder/Cinema_Bussiness_Center_Platform/backend
mvn spring-boot:run
```

**éªŒè¯å¯åŠ¨æˆåŠŸ**:
```bash
curl http://localhost:8080/api/skus
```

é¢„æœŸè¿”å›:
```json
{
  "success": true,
  "data": [...],
  "total": 0,
  "page": 1,
  "pageSize": 20
}
```

### 2. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd /Users/lining/qoder/Cinema_Bussiness_Center_Platform/frontend
npm install  # é¦–æ¬¡è¿è¡Œ
npm run dev
```

**è®¿é—®åœ°å€**: http://localhost:5173

---

## ğŸ¯ éªŒæ”¶åœºæ™¯éªŒè¯

### åœºæ™¯1: åˆ›å»ºåŸæ–™SKU

**å¯¹åº”ç”¨æˆ·æ•…äº‹**: US-001 ç”¨æˆ·æ•…äº‹1 - åˆ›å»ºåŸæ–™SKU (P1)

**é¡µé¢æ“ä½œ**:
1. è®¿é—®: http://localhost:5173/products/sku
2. ç‚¹å‡»ã€Œæ–°å»ºSKUã€æŒ‰é’®
3. å¡«å†™åŸºæœ¬ä¿¡æ¯:
   - SKUç±»å‹: **åŸæ–™**
   - SKUåç§°: `Jack Daniel'så¨å£«å¿Œ`
   - è§„æ ¼: `700ml`
   - ä¸»å•ä½: `ml`
   - æ ‡å‡†æˆæœ¬: `0.50` å…ƒ/ml
4. ç‚¹å‡»ã€Œä¿å­˜ã€

**éªŒæ”¶æ ‡å‡†**:
- [ ] SKUæˆåŠŸä¿å­˜
- [ ] SKUåˆ—è¡¨æ˜¾ç¤ºç±»å‹æ ‡ç­¾ã€ŒåŸæ–™ã€(è“è‰²)
- [ ] å¯åœ¨BOMç»„ä»¶é€‰æ‹©ä¸­çœ‹åˆ°è¯¥SKU

**APIæµ‹è¯•**:
```bash
curl -X POST http://localhost:8080/api/skus \
  -H "Content-Type: application/json" \
  -d '{
    "code": "RM-001",
    "name": "Jack Danielså¨å£«å¿Œ",
    "spuId": "00000000-0000-0000-0000-000000000001",
    "skuType": "raw_material",
    "mainUnit": "ml",
    "standardCost": 0.50,
    "status": "draft"
  }'
```

---

### åœºæ™¯2: åˆ›å»ºåŒ…æSKU

**å¯¹åº”ç”¨æˆ·æ•…äº‹**: US-001 ç”¨æˆ·æ•…äº‹2 - åˆ›å»ºåŒ…æSKU (P1)

**é¡µé¢æ“ä½œ**:
1. è®¿é—®: http://localhost:5173/products/sku
2. ç‚¹å‡»ã€Œæ–°å»ºSKUã€æŒ‰é’®
3. å¡«å†™åŸºæœ¬ä¿¡æ¯:
   - SKUç±»å‹: **åŒ…æ**
   - SKUåç§°: `é«˜è„šæ¯`
   - ä¸»å•ä½: `ä¸ª`
   - æ ‡å‡†æˆæœ¬: `2.00` å…ƒ/ä¸ª
4. ç‚¹å‡»ã€Œä¿å­˜ã€

**éªŒæ”¶æ ‡å‡†**:
- [ ] SKUæˆåŠŸä¿å­˜
- [ ] SKUåˆ—è¡¨æ˜¾ç¤ºç±»å‹æ ‡ç­¾ã€ŒåŒ…æã€(ç»¿è‰²)
- [ ] å¯åœ¨BOMç»„ä»¶é€‰æ‹©ä¸­çœ‹åˆ°è¯¥SKU

**APIæµ‹è¯•**:
```bash
curl -X POST http://localhost:8080/api/skus \
  -H "Content-Type: application/json" \
  -d '{
    "code": "PK-001",
    "name": "é«˜è„šæ¯",
    "spuId": "00000000-0000-0000-0000-000000000001",
    "skuType": "packaging",
    "mainUnit": "ä¸ª",
    "standardCost": 2.00,
    "status": "draft"
  }'
```

---

### åœºæ™¯3: åˆ›å»ºæˆå“SKU + BOMé…ç½® (æ ¸å¿ƒ)

**å¯¹åº”ç”¨æˆ·æ•…äº‹**: US-001 ç”¨æˆ·æ•…äº‹3 - åˆ›å»ºæˆå“SKU (P2)

**å‰ç½®æ¡ä»¶**: å·²åˆ›å»ºåŸæ–™å’ŒåŒ…æSKU

**é¡µé¢æ“ä½œ**:
1. è®¿é—®: http://localhost:5173/products/sku
2. ç‚¹å‡»ã€Œæ–°å»ºSKUã€
3. å¡«å†™åŸºæœ¬ä¿¡æ¯:
   - SKUç±»å‹: **æˆå“**
   - SKUåç§°: `å¨å£«å¿Œå¯ä¹é¸¡å°¾é…’`
   - ä¸»å•ä½: `æ¯`
   - æŸè€—ç‡: `5%`
4. åˆ‡æ¢åˆ°ã€ŒBOMé…ç½®ã€Tab
5. ç‚¹å‡»ã€Œæ·»åŠ ç»„ä»¶ã€ï¼Œé€‰æ‹©:
   - å¨å£«å¿Œ 45ml (0.50å…ƒ/ml)
   - å¯ä¹åŸæ¶² 150ml (0.02å…ƒ/ml)
   - é«˜è„šæ¯ 1ä¸ª (2.00å…ƒ/ä¸ª)
   - å¸ç®¡ 1æ ¹ (0.10å…ƒ/æ ¹)
6. éªŒè¯æˆæœ¬è‡ªåŠ¨è®¡ç®—:
   - ç»„ä»¶æˆæœ¬ = 45Ã—0.50 + 150Ã—0.02 + 2.00 + 0.10 = **27.60**
   - å«5%æŸè€— = 27.60 Ã— 1.05 = **28.98**
7. ç‚¹å‡»ã€Œä¿å­˜ã€

**éªŒæ”¶æ ‡å‡†**:
- [ ] SKUæˆåŠŸä¿å­˜
- [ ] æ ‡å‡†æˆæœ¬å­—æ®µç¦ç”¨ï¼ˆä»BOMè®¡ç®—ï¼‰
- [ ] BOMç»„ä»¶æ˜ç»†æ­£ç¡®æ˜¾ç¤º
- [ ] æˆæœ¬è®¡ç®—å…¬å¼: Î£(ç»„ä»¶æ•°é‡ Ã— ç»„ä»¶å•ä½æˆæœ¬) Ã— (1 + æŸè€—ç‡)

**APIæµ‹è¯•**:
```bash
curl -X POST http://localhost:8080/api/skus \
  -H "Content-Type: application/json" \
  -d '{
    "code": "FP-001",
    "name": "å¨å£«å¿Œå¯ä¹é¸¡å°¾é…’",
    "spuId": "00000000-0000-0000-0000-000000000002",
    "skuType": "finished_product",
    "mainUnit": "æ¯",
    "wasteRate": 5.0,
    "status": "draft",
    "bomComponents": [
      {"componentId": "<å¨å£«å¿ŒSKUçš„ID>", "quantity": 45, "unit": "ml"},
      {"componentId": "<å¯ä¹åŸæ¶²SKUçš„ID>", "quantity": 150, "unit": "ml"},
      {"componentId": "<é«˜è„šæ¯SKUçš„ID>", "quantity": 1, "unit": "ä¸ª"},
      {"componentId": "<å¸ç®¡SKUçš„ID>", "quantity": 1, "unit": "æ ¹"}
    ]
  }'
```

---

### åœºæ™¯4: åˆ›å»ºå¥—é¤SKU

**å¯¹åº”ç”¨æˆ·æ•…äº‹**: US-001 ç”¨æˆ·æ•…äº‹4 - åˆ›å»ºç»„åˆ/å¥—é¤SKU (P3)

**å‰ç½®æ¡ä»¶**: å·²åˆ›å»ºæˆå“SKU

**é¡µé¢æ“ä½œ**:
1. è®¿é—®: http://localhost:5173/products/sku
2. ç‚¹å‡»ã€Œæ–°å»ºSKUã€
3. å¡«å†™åŸºæœ¬ä¿¡æ¯:
   - SKUç±»å‹: **å¥—é¤**
   - SKUåç§°: `è§‚å½±å°åƒå¥—é¤`
   - ä¸»å•ä½: `ä»½`
4. åˆ‡æ¢åˆ°ã€Œå¥—é¤é…ç½®ã€Tab
5. æ·»åŠ å­é¡¹:
   - å¨å£«å¿Œå¯ä¹ Ã— 2æ¯
   - å¤§ä»½çˆ†ç±³èŠ± Ã— 1ä»½
6. éªŒè¯å¥—é¤æˆæœ¬ = Î£(å­é¡¹æˆæœ¬)
7. ç‚¹å‡»ã€Œä¿å­˜ã€

**éªŒæ”¶æ ‡å‡†**:
- [ ] SKUæˆåŠŸä¿å­˜
- [ ] å¯é€‰æ‹©å¤šä¸ªæˆå“SKUä½œä¸ºå­é¡¹
- [ ] æ ‡å‡†æˆæœ¬ä¸ºæ‰€æœ‰å­é¡¹æˆæœ¬ä¹‹å’Œ
- [ ] ç±»å‹æ ‡ç­¾æ˜¾ç¤ºã€Œå¥—é¤ã€(ç´«è‰²)

**APIæµ‹è¯•**:
```bash
curl -X POST http://localhost:8080/api/skus \
  -H "Content-Type: application/json" \
  -d '{
    "code": "CB-001",
    "name": "è§‚å½±å°åƒå¥—é¤",
    "spuId": "00000000-0000-0000-0000-000000000003",
    "skuType": "combo",
    "mainUnit": "ä»½",
    "status": "draft",
    "comboItems": [
      {"subItemId": "<å¨å£«å¿Œå¯ä¹SKUçš„ID>", "quantity": 2, "unit": "æ¯"},
      {"subItemId": "<å¤§ä»½çˆ†ç±³èŠ±SKUçš„ID>", "quantity": 1, "unit": "ä»½"}
    ]
  }'
```

---

### åœºæ™¯5: SKUçŠ¶æ€ç®¡ç†

**å¯¹åº”ç”¨æˆ·æ•…äº‹**: US-001 ç”¨æˆ·æ•…äº‹5 - ç®¡ç†SKUçŠ¶æ€å’Œé—¨åº—èŒƒå›´ (P2)

**é¡µé¢æ“ä½œ**:
1. è®¿é—®: http://localhost:5173/products/sku
2. é€‰æ‹©ä¸€ä¸ªè‰ç¨¿çŠ¶æ€çš„SKU
3. ç‚¹å‡»ã€Œå¯ç”¨ã€æŒ‰é’®
4. éªŒè¯çŠ¶æ€å˜ä¸ºã€Œå·²å¯ç”¨ã€
5. ç‚¹å‡»ã€Œåœç”¨ã€æŒ‰é’®
6. éªŒè¯çŠ¶æ€å˜ä¸ºã€Œå·²åœç”¨ã€

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ”¯æŒçŠ¶æ€è½¬æ¢: è‰ç¨¿â†’å·²å¯ç”¨â†’å·²åœç”¨â†’å·²å¯ç”¨
- [ ] è‰ç¨¿/å·²åœç”¨SKUä¸èƒ½ç”¨äºæ–°BOMé…æ–¹
- [ ] åœç”¨æœ‰BOMå¼•ç”¨çš„SKUæ—¶æ˜¾ç¤ºè­¦å‘Š

**APIæµ‹è¯•**:
```bash
# å¯ç”¨SKU
curl -X PUT http://localhost:8080/api/skus/{skuId}/status \
  -H "Content-Type: application/json" \
  -d '{"status": "enabled"}'

# åœç”¨SKU
curl -X PUT http://localhost:8080/api/skus/{skuId}/status \
  -H "Content-Type: application/json" \
  -d '{"status": "disabled"}'
```

---

### åœºæ™¯6: é—¨åº—èŒƒå›´é…ç½®

**å¯¹åº”ç”¨æˆ·æ•…äº‹**: US-001 ç”¨æˆ·æ•…äº‹5 - ç®¡ç†SKUçŠ¶æ€å’Œé—¨åº—èŒƒå›´ (P2)

**é¡µé¢æ“ä½œ**:
1. ç¼–è¾‘ä¸€ä¸ªSKU
2. é…ç½®é—¨åº—èŒƒå›´:
   - é€‰æ‹©ã€Œç‰¹å®šé—¨åº—ã€
   - å‹¾é€‰: é—¨åº—Aã€é—¨åº—B
3. ä¿å­˜
4. éªŒè¯è¯¥SKUä»…åœ¨é€‰å®šé—¨åº—å¯è§

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ”¯æŒé…ç½®ã€Œå…¨é—¨åº—ã€æˆ–ã€Œç‰¹å®šé—¨åº—ã€
- [ ] é—¨åº—èŒƒå›´éªŒè¯: æˆå“çš„é—¨åº—èŒƒå›´ âŠ† ç»„ä»¶çš„é—¨åº—èŒƒå›´
- [ ] ç­›é€‰åŠŸèƒ½æŒ‰é—¨åº—è¿‡æ»¤SKU

**APIæµ‹è¯•**:
```bash
# éªŒè¯é—¨åº—èŒƒå›´
curl -X POST http://localhost:8080/api/skus/{æˆå“ID}/validate-store-scope \
  -H "Content-Type: application/json" \
  -d '{"storeScope": ["store-1", "store-2"]}'
```

é¢„æœŸå“åº”:
```json
{
  "success": true,
  "data": {
    "valid": true,
    "errors": [],
    "warnings": []
  }
}
```

---

## ğŸ”§ æ•°æ®éªŒè¯SQL

```sql
-- æŸ¥çœ‹æ‰€æœ‰SKUåŠç±»å‹
SELECT id, code, name, sku_type, standard_cost, status, store_scope
FROM skus ORDER BY sku_type, code;

-- æŸ¥çœ‹æˆå“BOMé…ç½®
SELECT
    s1.name as finished_product,
    s2.name as component,
    bc.quantity,
    bc.unit,
    bc.unit_cost,
    (bc.quantity * bc.unit_cost) as total_cost
FROM bom_components bc
JOIN skus s1 ON bc.finished_product_id = s1.id
JOIN skus s2 ON bc.component_id = s2.id
ORDER BY s1.name, bc.sort_order;

-- éªŒè¯æˆæœ¬è®¡ç®—
SELECT
    s.name,
    s.standard_cost,
    s.waste_rate,
    (SELECT SUM(quantity * unit_cost) FROM bom_components WHERE finished_product_id = s.id) as component_cost
FROM skus s
WHERE s.sku_type = 'finished_product';

-- æŸ¥çœ‹å¥—é¤é…ç½®
SELECT
    s1.name as combo,
    s2.name as sub_item,
    ci.quantity,
    ci.unit_cost
FROM combo_items ci
JOIN skus s1 ON ci.combo_id = s1.id
JOIN skus s2 ON ci.sub_item_id = s2.id
ORDER BY s1.name, ci.sort_order;
```

---

## ğŸ“‹ éªŒæ”¶æ£€æŸ¥æ¸…å•

### åŠŸèƒ½éœ€æ±‚éªŒæ”¶

| ç¼–å· | éœ€æ±‚ | çŠ¶æ€ |
|------|------|------|
| FR-001 | æ”¯æŒå››ç§SKUç±»å‹: åŸæ–™/åŒ…æ/æˆå“/å¥—é¤ | â¬œ |
| FR-002 | SKUåˆ—è¡¨æ˜¾ç¤ºç±»å‹æ ‡ç­¾(è“/ç»¿/æ©™/ç´«) | â¬œ |
| FR-003 | åŸæ–™/åŒ…æéœ€è¦æ‰‹åŠ¨è¾“å…¥æˆæœ¬ï¼Œæˆå“/å¥—é¤è‡ªåŠ¨è®¡ç®— | â¬œ |
| FR-004 | æ”¯æŒæŒ‰ç±»å‹ç­›é€‰SKUåˆ—è¡¨ | â¬œ |
| FR-005 | å¿…å¡«å­—æ®µ: SKUç±»å‹ã€åç§°ã€ä¸»åº“å­˜å•ä½ | â¬œ |
| FR-017 | æˆå“æˆæœ¬å…¬å¼: Î£(æ•°é‡Ã—å•ä½æˆæœ¬)Ã—(1+æŸè€—ç‡) | â¬œ |
| FR-018 | å¥—é¤æˆæœ¬ = Î£å­é¡¹æˆæœ¬ | â¬œ |
| FR-020 | ä¸‰ç§çŠ¶æ€: è‰ç¨¿/å·²å¯ç”¨/å·²åœç”¨ | â¬œ |
| FR-024 | é—¨åº—èŒƒå›´é…ç½® | â¬œ |
| FR-025 | é—¨åº—èŒƒå›´éªŒè¯(ç»„ä»¶è¦†ç›–æˆå“) | â¬œ |

### è¾¹ç•Œæƒ…å†µéªŒæ”¶

| åœºæ™¯ | é¢„æœŸè¡Œä¸º | çŠ¶æ€ |
|------|---------|------|
| æˆå“æ— BOMæ—¶å¯ç”¨ | é˜»æ­¢å¯ç”¨ï¼Œæ˜¾ç¤ºè­¦å‘Š | â¬œ |
| åˆ é™¤è¢«BOMå¼•ç”¨çš„åŸæ–™ | é˜»æ­¢åˆ é™¤ï¼Œåˆ—å‡ºå¼•ç”¨ | â¬œ |
| åˆ›å»ºé‡å¤SKUç¼–ç  | æ˜¾ç¤ºå”¯ä¸€æ€§éªŒè¯é”™è¯¯ | â¬œ |
| é—¨åº—èŒƒå›´å†²çª | é˜»æ­¢å¯ç”¨ï¼Œæç¤ºç»„ä»¶ä¸å¯ç”¨ | â¬œ |
| å¥—é¤å­é¡¹è¢«åœç”¨ | è­¦å‘Šå¥—é¤åŒ…å«å·²åœç”¨å•†å“ | â¬œ |

---

## â“ å¸¸è§é—®é¢˜

### Q: å‰ç«¯çœ‹ä¸åˆ°æ•°æ®ï¼Ÿ
æ£€æŸ¥åç«¯æ˜¯å¦å¯åŠ¨ï¼Œç¡®è®¤ http://localhost:8080/api/skus è¿”å›æ­£å¸¸

### Q: æˆæœ¬è®¡ç®—ä¸å¯¹ï¼Ÿ
æ£€æŸ¥BOMç»„ä»¶çš„ unit_cost æ˜¯å¦æ­£ç¡®ï¼ŒæŸè€—ç‡æ˜¯å¦åœ¨0-100èŒƒå›´å†…

### Q: é—¨åº—èŒƒå›´éªŒè¯å¤±è´¥ï¼Ÿ
æ£€æŸ¥æˆå“çš„é—¨åº—èŒƒå›´æ˜¯å¦æ˜¯ç»„ä»¶é—¨åº—èŒƒå›´çš„å­é›†

### Q: æ•°æ®å¦‚ä½•é‡ç½®ï¼Ÿ
```sql
TRUNCATE TABLE bom_components CASCADE;
TRUNCATE TABLE combo_items CASCADE;
DELETE FROM skus;
```

---

**æ–‡æ¡£å®Œæˆ** âœ…
