# SKUä¸»æ•°æ®ç®¡ç†(æ”¯æŒBOM) - å®ç°æ€»ç»“

**åŠŸèƒ½åˆ†æ”¯**: `P001-sku-master-data`
**å®æ–½æ—¥æœŸ**: 2025-12-24
**çŠ¶æ€**: âœ… æ ¸å¿ƒå®ç°å®Œæˆ

---

## ğŸ“‹ å®ç°æ¦‚è§ˆ

æœ¬åŠŸèƒ½æ‰©å±•ç°æœ‰SKUç®¡ç†ç³»ç»Ÿ,æ”¯æŒå››ç§SKUç±»å‹(åŸæ–™ã€åŒ…æã€æˆå“ã€å¥—é¤),å®ç°æˆå“BOM(ç‰©æ–™æ¸…å•)é…ç½®å’Œæ ‡å‡†æˆæœ¬è‡ªåŠ¨è®¡ç®—ã€‚

### æ ¸å¿ƒä»·å€¼
- âœ… æ”¯æŒå½±é™¢é…’å§å¼å¤šåœºæ™¯ç»è¥
- âœ… é¸¡å°¾é…’/å°åƒç­‰æˆå“çš„é…æ–¹æ ‡å‡†åŒ–
- âœ… æˆæœ¬é€æ˜åŒ–å’Œè‡ªåŠ¨è®¡ç®—
- âœ… é—¨åº—èŒƒå›´çµæ´»é…ç½®

---

## âœ… å·²å®Œæˆå†…å®¹

### Phase 0: æ•°æ®åº“è¿ç§»è„šæœ¬ (100% å®Œæˆ)

**æ–‡ä»¶ä½ç½®**: `backend/src/main/resources/db/migration/`

| è„šæœ¬ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| V001__create_skus_table.sql | åˆ›å»ºSKUä¸»è¡¨,æ”¯æŒ4ç§ç±»å‹ | âœ… |
| V002__create_bom_combo_tables.sql | åˆ›å»ºBOMç»„ä»¶å’Œå¥—é¤å­é¡¹è¡¨ | âœ… |
| V003__create_unit_conversions.sql | åˆ›å»ºå•ä½æ¢ç®—è¡¨åŠæµ‹è¯•æ•°æ® | âœ… |
| V004__insert_test_data.sql | å¯¼å…¥21ä¸ªSKUæµ‹è¯•æ•°æ® | âœ… |

**æ•°æ®åº“è¡¨ç»“æ„**:
- `skus` - SKUä¸»è¡¨ (æ‰©å±•æ”¯æŒsku_type, store_scope, waste_rate)
- `bom_components` - BOMç»„ä»¶è¡¨ (æˆå“ç‰©æ–™æ¸…å•)
- `combo_items` - å¥—é¤å­é¡¹è¡¨
- `unit_conversions` - å•ä½æ¢ç®—è¡¨

**æµ‹è¯•æ•°æ®**:
- 5ä¸ªåŸæ–™SKU (å¨å£«å¿Œã€å¯ä¹ç³–æµ†ã€è–„è·å¶ã€ç‰ç±³ç²’ã€é»„æ²¹)
- 5ä¸ªåŒ…æSKU (ç»ç’ƒæ¯ã€çº¸æ¯ã€å¸ç®¡ã€çˆ†ç±³èŠ±æ¡¶ã€è¢‹)
- 8ä¸ªæˆå“SKU (å¨å£«å¿Œå¯ä¹ã€è–„è·å¨å£«å¿Œã€çˆ†ç±³èŠ±ç­‰)
- 3ä¸ªå¥—é¤SKU (ç»å…¸è§‚å½±ã€è±ªåè§‚å½±ã€æƒ…ä¾£ç•…é¥®)

### Phase 1: åç«¯æ ¸å¿ƒå®ç° (100% å®Œæˆ) âœ…

**å®ä½“ç±»** (100%):
- âœ… `Sku.java` - SKUå®ä½“,æ”¯æŒ4ç§ç±»å‹
- âœ… `BomComponent.java` - BOMç»„ä»¶å®ä½“
- âœ… `ComboItem.java` - å¥—é¤å­é¡¹å®ä½“
- âœ… `SkuType.java` å’Œ `SkuStatus.java` - æšä¸¾ç±»

**Repositoryå±‚** (100%):
- âœ… `SkuRepository.java` - SKUæ•°æ®è®¿é—®(Supabase REST API)
- âœ… `BomComponentRepository.java` - BOMæ•°æ®è®¿é—®
- âœ… `ComboItemRepository.java` - å¥—é¤æ•°æ®è®¿é—®

**Serviceå±‚** (100%):
- âœ… `CostCalculationService.java` - æˆæœ¬è®¡ç®—æœåŠ¡
  - æˆå“æˆæœ¬è®¡ç®—: Î£(ç»„ä»¶æˆæœ¬) Ã— (1 + æŸè€—ç‡)
  - å¥—é¤æˆæœ¬è®¡ç®—: Î£(å­é¡¹æˆæœ¬)
  - æˆæœ¬æ˜ç»†è®¡ç®—
- âœ… `StoreScopeValidationService.java` - é—¨åº—èŒƒå›´éªŒè¯æœåŠ¡
  - æˆå“/å¥—é¤é—¨åº—èŒƒå›´ä¸ç»„ä»¶/å­é¡¹ä¸€è‡´æ€§éªŒè¯
  - é”™è¯¯å’Œè­¦å‘Šæ¶ˆæ¯ç”Ÿæˆ
- âœ… `SkuService.java` - SKUä¸šåŠ¡æœåŠ¡å±‚
  - SKU CRUDæ“ä½œ
  - BOMé…ç½®ç®¡ç†
  - å¥—é¤å­é¡¹ç®¡ç†
  - æˆæœ¬é‡æ–°è®¡ç®—
  - é—¨åº—èŒƒå›´éªŒè¯

**DTOå±‚** (100%):
- âœ… `SkuCreateRequest.java` - åˆ›å»ºSKUè¯·æ±‚(å«BOMå’Œå¥—é¤å­é¡¹)
- âœ… `SkuUpdateRequest.java` - æ›´æ–°SKUè¯·æ±‚
- âœ… `SkuDetailDTO.java` - SKUè¯¦æƒ…DTO(å«BOMå’Œå¥—é¤å­é¡¹)
- âœ… `UpdateBomRequest.java` - æ›´æ–°BOMé…ç½®è¯·æ±‚
- âœ… `UpdateComboItemsRequest.java` - æ›´æ–°å¥—é¤å­é¡¹è¯·æ±‚

**Controllerå±‚** (100%):
- âœ… `SkuController.java` - SKU CRUD API
  - `GET /api/skus` - æŸ¥è¯¢SKUåˆ—è¡¨(æ”¯æŒç­›é€‰)
  - `POST /api/skus` - åˆ›å»ºSKU
  - `PUT /api/skus/{id}` - æ›´æ–°SKU
  - `DELETE /api/skus/{id}` - åˆ é™¤SKU(æ£€æŸ¥å¼•ç”¨)
  - `GET /api/skus/{id}` - è·å–SKUè¯¦æƒ…
  - `POST /api/skus/{id}/recalculate-cost` - æ‰‹åŠ¨é‡æ–°è®¡ç®—æˆæœ¬
  - `POST /api/skus/{id}/validate-store-scope` - éªŒè¯é—¨åº—èŒƒå›´
- âœ… `BomController.java` - BOMç®¡ç†API
  - `GET /api/skus/{id}/bom` - è·å–BOMé…ç½®
  - `PUT /api/skus/{id}/bom` - æ›´æ–°BOM(è‡ªåŠ¨é‡æ–°è®¡ç®—æˆæœ¬)
- âœ… `ComboController.java` - å¥—é¤ç®¡ç†API
  - `GET /api/skus/{id}/combo-items` - è·å–å¥—é¤å­é¡¹
  - `PUT /api/skus/{id}/combo-items` - æ›´æ–°å¥—é¤å­é¡¹

### Phase 2: å‰ç«¯ç±»å‹å®šä¹‰ (100% å®Œæˆ)

**æ–‡ä»¶ä½ç½®**: `frontend/src/types/sku.ts`

**å·²æ·»åŠ ç±»å‹**:
- âœ… `SkuType` - SKUç±»å‹æšä¸¾ (RAW_MATERIAL | PACKAGING | FINISHED_PRODUCT | COMBO)
- âœ… `BomComponent` - BOMç»„ä»¶æ¥å£
- âœ… `ComboItem` - å¥—é¤å­é¡¹æ¥å£
- âœ… `SKUDetail` - SKUè¯¦æƒ…æ¥å£(åŒ…å«BOMå’Œå¥—é¤ä¿¡æ¯)
- âœ… `BomComponentInput` - BOMç»„ä»¶è¾“å…¥æ¥å£
- âœ… `ComboItemInput` - å¥—é¤å­é¡¹è¾“å…¥æ¥å£
- âœ… `CostBreakdown` - æˆæœ¬æ˜ç»†æ¥å£
- âœ… `SKU_TYPE_CONFIG` - SKUç±»å‹é…ç½®å¸¸é‡
- âœ… `SKU_STATUS_CONFIG` - SKUçŠ¶æ€é…ç½®å¸¸é‡

**å·²æ‰©å±•SKUæ¥å£å­—æ®µ**:
- âœ… `skuType: SkuType` - SKUç±»å‹
- âœ… `storeScope: string[]` - é—¨åº—èŒƒå›´
- âœ… `standardCost?: number` - æ ‡å‡†æˆæœ¬
- âœ… `wasteRate?: number` - æŸè€—ç‡

---

## â³ å¾…å®ç°å†…å®¹

### Phase 1: åç«¯æµ‹è¯• (è´¨é‡ä¿è¯)

- â³ **Backend Tests** (T013-T015)
  - Repositoryå±‚æµ‹è¯•
  - Serviceå±‚æµ‹è¯•
  - Controlleré›†æˆæµ‹è¯•

### Phase 2: å‰ç«¯å‰©ä½™éƒ¨åˆ†

#### é«˜ä¼˜å…ˆçº§ (MVPå¿…éœ€)
- â³ **MSW Mock Handlers** (T019) - å‰ç«¯Mockæ•°æ®
- â³ **Test Data** (T020) - å‰ç«¯æµ‹è¯•æ•°æ®

- â³ **BasicInfoTab Extension** (T021) - æ·»åŠ SKUç±»å‹é€‰æ‹©å™¨
- â³ **SkuTable Extension** (T022) - æ·»åŠ SKUç±»å‹åˆ—
- â³ **BomTab Component** (T023-T024) - BOMé…ç½®Tab
- â³ **ComboItemsTab Component** (T025) - å¥—é¤å­é¡¹Tab
- â³ **Store Scope Validation UI** (T026) - é—¨åº—éªŒè¯åé¦ˆ
- â³ **Cost Breakdown Component** (T027) - æˆæœ¬æ˜ç»†å±•ç¤º

#### ä¸­ä¼˜å…ˆçº§ (ç”¨æˆ·ä½“éªŒ)
- â³ **SKU List Filtering** (T028) - ç±»å‹å’Œé—¨åº—ç­›é€‰
- â³ **Frontend Unit Tests** (T029)
- â³ **Frontend E2E Tests** (T030)

### Phase 5: æ–‡æ¡£ (éƒ¨åˆ†å®Œæˆ)

- âœ… **Implementation Summary** (æœ¬æ–‡æ¡£)
- â³ **API Documentation** (T034) - Swaggeræ–‡æ¡£
- â³ **User Manual** (T035) - ç”¨æˆ·æ“ä½œæ‰‹å†Œ
- â³ **Demo Video** (T036) - åŠŸèƒ½æ¼”ç¤ºè§†é¢‘
- â³ **Environment Configuration** (T037) - ç¯å¢ƒå˜é‡é…ç½®
- â³ **Deployment Guide** (T038) - éƒ¨ç½²æ–‡æ¡£

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ•°æ®åº“åˆå§‹åŒ–

```bash
# æ–¹å¼1: ä½¿ç”¨ Supabase æ§åˆ¶å°
# ç™»å½• Supabase é¡¹ç›® â†’ SQL Editor â†’ æ‰§è¡Œä»¥ä¸‹è„šæœ¬:
# 1. V001__create_skus_table.sql
# 2. V002__create_bom_combo_tables.sql
# 3. V003__create_unit_conversions.sql
# 4. V004__insert_test_data.sql

# æ–¹å¼2: ä½¿ç”¨ Spring Boot è‡ªåŠ¨è¿ç§» (éœ€é…ç½® Flyway)
cd backend
./mvnw spring-boot:run
```

### å‰ç«¯å¼€å‘

```bash
# å®‰è£…ä¾èµ–
cd frontend
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# è®¿é—® http://localhost:5173
```

### åç«¯å¼€å‘

```bash
# å®‰è£…ä¾èµ–
cd backend
./mvnw clean install

# å¯åŠ¨æœåŠ¡
./mvnw spring-boot:run

# API è®¿é—® http://localhost:8080
```

---

## ğŸ“Š è¿›åº¦ç»Ÿè®¡

| é˜¶æ®µ | ä»»åŠ¡æ•° | å·²å®Œæˆ | è¿›åº¦ |
|------|--------|--------|------|
| **Phase 0: æ•°æ®åº“** | 4 | 4 | 100% âœ… |
| **Phase 1: åç«¯** | 12 | 12 | 100% âœ… |
| **Phase 2: å‰ç«¯ç±»å‹** | 5 | 5 | 100% âœ… |
| **Phase 3: å‰ç«¯ç»„ä»¶** | 10 | 0 | 0% â³ |
| **Phase 4: æ•°æ®** | 3 | 1 | 33% ğŸŸ¡ |
| **Phase 5: æ–‡æ¡£** | 5 | 1 | 20% ğŸŸ¡ |
| **æ€»è®¡** | 39 MVPä»»åŠ¡ | 23 | **59%** ğŸŸ¡ |

### æ ¸å¿ƒåŠŸèƒ½å®Œæˆåº¦

| åŠŸèƒ½æ¨¡å— | å®Œæˆåº¦ |
|---------|--------|
| æ•°æ®åº“è¡¨ç»“æ„ | 100% âœ… |
| æµ‹è¯•æ•°æ® | 100% âœ… |
| åç«¯å®ä½“å’Œä»“å‚¨ | 100% âœ… |
| åç«¯ä¸šåŠ¡é€»è¾‘ | 100% âœ… |
| åç«¯API | 100% âœ… |
| å‰ç«¯ç±»å‹å®šä¹‰ | 100% âœ… |
| å‰ç«¯Mockæ•°æ® | 0% â³ |
| å‰ç«¯ç»„ä»¶ | 0% â³ |

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯æ‰§è¡Œ (å¼€å‘è€…)

1. **æ•°æ®åº“è¿ç§»**: åœ¨Supabaseæ‰§è¡Œ4ä¸ªè¿ç§»è„šæœ¬ âœ…
2. **æµ‹è¯•æ•°æ®éªŒè¯**: æ£€æŸ¥21ä¸ªSKUæ˜¯å¦æ­£ç¡®å¯¼å…¥ âœ…
3. **åç«¯APIæµ‹è¯•**: å¯åŠ¨Spring BootæœåŠ¡,ä½¿ç”¨Postman/curlæµ‹è¯•API
4. **å‰ç«¯Mockæ•°æ®**: åˆ›å»ºMSW handlers (T019)
5. **å‰ç«¯ç»„ä»¶å¼€å‘**: å®ç°SKUç±»å‹é€‰æ‹©å™¨å’ŒBOMé…ç½®Tab (T021-T027)

### çŸ­æœŸç›®æ ‡ (1-2å‘¨)

- âœ… å®Œæˆåç«¯APIå®ç° (T009-T012å·²å®Œæˆ)
- â³ å®Œæˆå‰ç«¯ç»„ä»¶MVPç‰ˆæœ¬ (T019-T030)
- â³ ç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯

### ä¸­æœŸç›®æ ‡ (2-4å‘¨)

- å®Œå–„æµ‹è¯•è¦†ç›–ç‡
- ç¼–å†™ç”¨æˆ·æ–‡æ¡£å’ŒAPIæ–‡æ¡£
- æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨åŠ å›º

---

## ğŸ“ æŠ€æœ¯å€ºåŠ¡

1. **åç«¯Controllerå±‚ç¼ºå¤±**: éœ€å®ç°å®Œæ•´çš„REST API
2. **å‰ç«¯ç»„ä»¶æœªå®ç°**: éœ€å®ç°SKUè¡¨å•å’ŒBOMé…ç½®UI
3. **æµ‹è¯•è¦†ç›–ä¸è¶³**: ç¼ºå°‘å•å…ƒæµ‹è¯•å’ŒE2Eæµ‹è¯•
4. **æ–‡æ¡£ä¸å®Œæ•´**: éœ€è¡¥å……APIæ–‡æ¡£å’Œç”¨æˆ·æ‰‹å†Œ

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [åŠŸèƒ½è§„æ ¼](./spec.md)
- [å®æ–½è®¡åˆ’](./plan.md)
- [æ•°æ®æ¨¡å‹](./data-model.md)
- [å¿«é€Ÿå¼€å§‹](./quickstart.md)
- [ä»»åŠ¡æ¸…å•](./tasks.md)

---

**æœ€åæ›´æ–°**: 2025-12-24
**è´Ÿè´£äºº**: AI Assistant
**çŠ¶æ€**: æ ¸å¿ƒå®ç°å®Œæˆ,å¾…å‰åç«¯é›†æˆ
