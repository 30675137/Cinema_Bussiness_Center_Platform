# 前端菜单结构调整方案

> 文档版本：v1.0  
> 创建日期：2026-01-13  
> 文档状态：待评审  
> 关联文档：[微服务架构拆分方案](./[todo]微服务架构拆分方案.md)

---

## 1. 背景与目标

### 1.1 背景

当前前端菜单结构存在以下问题：

1. **功能归属混乱** - 菜单项分布未按业务服务边界划分
2. **无效菜单过多** - 约 40+ 个菜单项指向不存在的路由
3. **路由命名不一致** - 如 `/scenario-package` vs `/scenario-packages`
4. **不利于微服务演进** - 菜单结构与规划的微服务边界不匹配

### 1.2 目标

1. **对齐微服务架构** - 菜单结构与微服务边界一致
2. **清理无效菜单** - 移除或标记未实现功能
3. **统一命名规范** - 路由命名保持一致
4. **便于权限管理** - 一个服务模块对应一组权限

---

## 2. 菜单与微服务映射关系

### 2.1 服务边界定义

根据微服务架构拆分方案，系统划分为以下服务域：

| 服务域 | 微服务 | 职责 |
|--------|--------|------|
| **平台服务** | IAM + 配置中心 | 身份认证、权限、配置管理 |
| **主数据域** | 商品中心(MDM) | SPU/SKU、分类、品牌、价格 |
| **主数据域** | BOM/物料中心(MOM) | 物料、配方、单位换算 |
| **主数据域** | 门店资源中心(Store) | 门店、影厅、场景包、排期 |
| **交易域** | 订单中心(OMS) | 订单、履约、核销、退款 |
| **交易域** | 库存中心(IMS) | 库存台账、预占、调拨、盘点 |
| **交易域** | 供应链服务(SCM) | 供应商、采购、收货 |
| **交易域** | 预约中心(RMS) | 预约单、档期管理 |
| **渠道营销域** | 渠道商品服务(Channel) | 小程序商品、菜单配置 |
| **渠道营销域** | 会员中心(Member) | 会员体系、积分 |
| **渠道营销域** | 营销中心(Marketing) | 优惠券、促销活动 |
| **支撑域** | 数据分析服务(BI) | 报表、看板 |

### 2.2 菜单与服务映射图

```
┌─────────────────────────────────────────────────────────────────┐
│                        前端菜单结构                               │
├───────────────────────┬─────────────────────────────────────────┤
│  菜单模块              │  对应微服务                              │
├───────────────────────┼─────────────────────────────────────────┤
│  🏠 工作台             │  Dashboard                              │
│  🔐 平台管理           │  cinema-iam-service + config-service    │
│  📦 商品中心(MDM)      │  cinema-product-service                 │
│  🏭 BOM/物料中心       │  cinema-bom-service                     │
│  🏪 门店资源中心       │  cinema-store-service                   │
│  📝 订单中心(OMS)      │  cinema-order-service                   │
│  📦 库存中心(IMS)      │  cinema-inventory-service               │
│  🛒 供应链(SCM)        │  cinema-scm-service                     │
│  🎬 预约中心(RMS)      │  cinema-reservation-service             │
│  📱 渠道商品           │  cinema-channel-service                 │
│  👤 会员中心           │  cinema-member-service (规划中)         │
│  🎁 营销中心           │  cinema-marketing-service (规划中)      │
│  📊 数据分析(BI)       │  cinema-bi-service (规划中)             │
└───────────────────────┴─────────────────────────────────────────┘
```

---

## 3. 调整详情

### 3.1 需要移动的菜单项

| 菜单项 | 原位置 | 新位置 | 理由 |
|--------|--------|--------|------|
| 门店管理 | 档期/排期/资源预约 | 门店资源中心 | Store服务独立模块 |
| 调拨管理 | 采购与入库管理 | 库存中心(IMS) | 调拨是库存域操作 |
| 预约单管理 | 订单与履约管理 | 预约中心(RMS) | RMS独立服务职责 |
| 单位管理 | 基础设置 | BOM/物料中心 | 单位是物料域数据 |
| 价格管理 | 独立模块 | 商品中心(MDM) | 价格是商品属性 |
| 用户/角色管理 | 系统管理 | 平台管理 | IAM服务职责 |

### 3.2 需要移除或标记的菜单项

以下菜单项对应路由不存在，建议移除或标记为"开发中"：

#### 基础设置模块（移除 4 项）
- `/basic-settings/organization` - 组织/门店/仓库管理
- `/basic-settings/dictionary` - 字典与规则配置
- `/basic-settings/roles` - 角色与权限管理
- `/basic-settings/approval` - 审批流配置

#### 商品管理模块（移除 6 项）
- `/products/attributes` - 属性/规格/条码设置
- `/products/status` - 商品状态/上下架管理
- `/products/content` - 内容编辑
- `/products/media` - 素材库管理
- `/products/channel-mapping` - 渠道映射字段管理
- `/products/publish` - 内容发布/审核/版本管理

#### BOM/配方模块（移除 3 项）
- `/bom/formula` - BOM/配方配置
- `/bom/cost` - 成本/毛利预估与校验
- `/bom/version` - BOM/配方版本管理

#### 场景包模块（移除 7 项）
- `/scenario-package/template` - 场景包模板管理
- `/scenario-package/resources` - 适用资源/影厅/门店规则
- `/scenario-package/content` - 内容组合配置
- `/scenario-package/add-on` - 加购策略管理
- `/scenario-package/pricing` - 定价策略配置
- `/scenario-package/package-price` - 包装价格 & 一口价设定
- `/scenario-package/version` - 场景包版本管理

#### 价格体系模块（移除 3 项）
- `/pricing/price-list` - 价目表管理
- `/pricing/audit` - 价格审核与生效
- `/pricing/rules` - 价格规则配置

#### 排期管理模块（移除 5 项）
- `/activity-types` - 活动类型管理
- `/schedule/conflict` - 冲突校验/占用规则
- `/schedule/status` - 排期状态管理
- `/schedule/publish` - 渠道发布/同步
- `/schedule/changes` - 排期变更/取消/改期

#### 订单管理模块（移除 5 项）
- `/orders/confirmation` - 二次确认队列
- `/orders/verification` - 核销码/到店核销
- `/orders/deduction` - 库存扣减/BOM扣原料
- `/orders/refund` - 退款/改期/取消/回滚
- `/orders/exceptions` - 异常订单/审计日志

#### 运营报表模块（整体标记为开发中）
- 所有 6 个菜单项均无对应路由

#### 系统管理模块（整体标记为开发中）
- 所有 5 个菜单项均无对应路由

---

## 4. 新菜单结构定义

### 4.1 完整菜单配置

```typescript
// AppLayout.tsx - menuItems 配置

const menuItems = [
  // ==================== 工作台 ====================
  {
    key: '/dashboard',
    icon: <HomeOutlined />,
    label: '工作台',
  },

  // ==================== 平台服务 ====================
  {
    key: '/platform',
    icon: <SafetyOutlined />,
    label: '平台管理',
    children: [
      {
        key: '/basic-settings/units',
        label: '计量单位管理',
      },
    ],
  },

  // ==================== 主数据域 ====================
  {
    key: '/mdm',
    icon: <ShoppingOutlined />,
    label: '商品中心 (MDM)',
    children: [
      {
        key: '/mdm-pim/category',
        label: '类目管理',
      },
      {
        key: '/mdm-pim/brands',
        label: '品牌管理',
      },
      {
        key: '/mdm-pim/attribute',
        label: '属性字典',
      },
      {
        key: '/products/spu',
        label: 'SPU 管理',
      },
      {
        key: '/products/sku',
        label: 'SKU 管理',
      },
      {
        key: '/price-management',
        label: '价格管理',
      },
    ],
  },
  {
    key: '/bom',
    icon: <ReconciliationOutlined />,
    label: 'BOM/物料中心',
    children: [
      {
        key: '/bom/materials',
        label: '物料主数据',
      },
      {
        key: '/bom/conversion',
        label: '单位换算配置',
      },
    ],
  },
  {
    key: '/store',
    icon: <GoldOutlined />,
    label: '门店资源中心',
    children: [
      {
        key: '/stores',
        label: '门店管理',
      },
      {
        key: '/schedule/hall-resources',
        label: '影厅资源',
      },
      {
        key: '/scenario-packages',
        label: '场景包管理',
      },
      {
        key: '/schedule/gantt',
        label: '排期管理',
      },
      {
        key: '/schedule/create',
        label: '新建排期',
      },
    ],
  },

  // ==================== 交易域 ====================
  {
    key: '/oms',
    icon: <FileTextOutlined />,
    label: '订单中心 (OMS)',
    children: [
      {
        key: '/orders/list',
        label: '订单列表',
      },
    ],
  },
  {
    key: '/ims',
    icon: <DatabaseOutlined />,
    label: '库存中心 (IMS)',
    children: [
      {
        key: '/inventory/query',
        label: '库存查询',
      },
      {
        key: '/inventory/ledger',
        label: '库存台账',
      },
      {
        key: '/inventory/operations',
        label: '出入库操作',
      },
      {
        key: '/inventory/transfer',
        label: '调拨管理',
      },
      {
        key: '/inventory/stocktaking',
        label: '盘点管理',
      },
      {
        key: '/inventory/reservation',
        label: '库存预占',
      },
      {
        key: '/inventory/movements',
        label: '变动日志',
      },
      {
        key: '/inventory/approvals',
        label: '库存审批',
      },
    ],
  },
  {
    key: '/scm',
    icon: <ShoppingCartOutlined />,
    label: '供应链 (SCM)',
    children: [
      {
        key: '/purchase-management/suppliers',
        label: '供应商管理',
      },
      {
        key: '/purchase-management/orders',
        label: '采购订单',
      },
      {
        key: '/purchase-management/orders/list',
        label: '采购订单列表',
      },
      {
        key: '/purchase-management/receipts',
        label: '收货入库',
      },
    ],
  },
  {
    key: '/rms',
    icon: <CalendarOutlined />,
    label: '预约中心 (RMS)',
    children: [
      {
        key: '/reservation-orders',
        label: '预约单管理',
      },
    ],
  },

  // ==================== 渠道与营销域 ====================
  {
    key: '/channel',
    icon: <CoffeeOutlined />,
    label: '渠道商品',
    children: [
      {
        key: '/channel-products/mini-program',
        label: '小程序商品',
      },
      {
        key: '/menu-category',
        label: '菜单分类',
      },
    ],
  },
  {
    key: '/member',
    icon: <UserOutlined />,
    label: '会员中心',
    disabled: true,
    children: [
      {
        key: '/member/list',
        label: '会员管理 (规划中)',
        disabled: true,
      },
    ],
  },
  {
    key: '/marketing',
    icon: <GiftOutlined />,
    label: '营销中心',
    disabled: true,
    children: [
      {
        key: '/marketing/coupon',
        label: '优惠券管理 (规划中)',
        disabled: true,
      },
    ],
  },

  // ==================== 支撑域 ====================
  {
    key: '/bi',
    icon: <BarChartOutlined />,
    label: '数据分析 (BI)',
    disabled: true,
    children: [
      {
        key: '/bi/sales',
        label: '销售报表 (规划中)',
        disabled: true,
      },
      {
        key: '/bi/dashboard',
        label: '运营看板 (规划中)',
        disabled: true,
      },
    ],
  },
  {
    key: '/system',
    icon: <SettingOutlined />,
    label: '系统管理',
    disabled: true,
    children: [
      {
        key: '/system/users',
        label: '用户管理 (规划中)',
        disabled: true,
      },
      {
        key: '/system/audit-log',
        label: '审计日志 (规划中)',
        disabled: true,
      },
    ],
  },
];
```

### 4.2 菜单层级结构图

```
影院业务中台
├── 🏠 工作台
│
├── 🔐 平台管理
│   └── 计量单位管理
│
├── ─────────── 主数据域 ───────────
│
├── 📦 商品中心 (MDM)
│   ├── 类目管理
│   ├── 品牌管理
│   ├── 属性字典
│   ├── SPU 管理
│   ├── SKU 管理
│   └── 价格管理
│
├── 🏭 BOM/物料中心
│   ├── 物料主数据
│   └── 单位换算配置
│
├── 🏪 门店资源中心
│   ├── 门店管理
│   ├── 影厅资源
│   ├── 场景包管理
│   ├── 排期管理
│   └── 新建排期
│
├── ─────────── 交易域 ───────────
│
├── 📝 订单中心 (OMS)
│   └── 订单列表
│
├── 📦 库存中心 (IMS)
│   ├── 库存查询
│   ├── 库存台账
│   ├── 出入库操作
│   ├── 调拨管理
│   ├── 盘点管理
│   ├── 库存预占
│   ├── 变动日志
│   └── 库存审批
│
├── 🛒 供应链 (SCM)
│   ├── 供应商管理
│   ├── 采购订单
│   ├── 采购订单列表
│   └── 收货入库
│
├── 🎬 预约中心 (RMS)
│   └── 预约单管理
│
├── ─────────── 渠道与营销域 ───────────
│
├── 📱 渠道商品
│   ├── 小程序商品
│   └── 菜单分类
│
├── 👤 会员中心 (规划中)
│   └── 会员管理
│
├── 🎁 营销中心 (规划中)
│   └── 优惠券管理
│
├── ─────────── 支撑域 ───────────
│
├── 📊 数据分析 (BI) (规划中)
│   ├── 销售报表
│   └── 运营看板
│
└── ⚙️ 系统管理 (规划中)
    ├── 用户管理
    └── 审计日志
```

---

## 5. 调整统计

### 5.1 数量统计

| 类型 | 数量 | 说明 |
|------|:----:|------|
| 原菜单总数 | ~70 | 包含所有层级 |
| 移除/标记菜单 | ~40 | 无对应路由的菜单 |
| 移动位置菜单 | 6 | 调整归属的菜单 |
| 保留有效菜单 | ~30 | 有对应路由的菜单 |
| 规划中菜单 | ~6 | 标记 disabled 的菜单 |

### 5.2 按服务统计

| 服务模块 | 菜单项数 | 状态 |
|----------|:--------:|------|
| 工作台 | 1 | ✅ 完整 |
| 平台管理 | 1 | ⚠️ 基础 |
| 商品中心 (MDM) | 6 | ✅ 完整 |
| BOM/物料中心 | 2 | ⚠️ 基础 |
| 门店资源中心 | 5 | ✅ 完整 |
| 订单中心 (OMS) | 1 | ⚠️ 基础 |
| 库存中心 (IMS) | 8 | ✅ 完整 |
| 供应链 (SCM) | 4 | ✅ 完整 |
| 预约中心 (RMS) | 1 | ⚠️ 基础 |
| 渠道商品 | 2 | ✅ 完整 |
| 会员中心 | 1 | 🔮 规划中 |
| 营销中心 | 1 | 🔮 规划中 |
| 数据分析 (BI) | 2 | 🔮 规划中 |
| 系统管理 | 2 | 🔮 规划中 |

---

## 6. 实施计划

### 6.1 实施步骤

```
Step 1: 备份现有菜单配置
  └── 保存 AppLayout.tsx 原始版本

Step 2: 更新菜单配置
  └── 替换 menuItems 数组

Step 3: 验证路由匹配
  └── 确认所有菜单项有对应路由

Step 4: 测试菜单功能
  └── 点击测试所有菜单项

Step 5: 更新面包屑配置
  └── 确保面包屑与新菜单结构一致
```

### 6.2 涉及文件

| 文件 | 修改内容 |
|------|----------|
| `frontend/src/components/layout/AppLayout.tsx` | 更新 menuItems 配置 |
| `frontend/src/components/layout/Router.tsx` | 无需修改（路由已存在） |

### 6.3 风险评估

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 用户习惯改变 | 低 | 菜单位置调整有限 |
| 功能丢失 | 无 | 仅移除无效菜单 |
| 权限配置影响 | 低 | 路由未变，权限不受影响 |

---

## 7. 后续规划

### 7.1 待补充菜单（随功能开发）

| 服务 | 待添加菜单 | 对应功能 |
|------|-----------|----------|
| 订单中心 | 核销管理 | 核销码生成与验证 |
| 订单中心 | 退款处理 | 退款申请与审核 |
| BOM中心 | BOM配方配置 | 配方管理功能 |
| 会员中心 | 会员列表、积分管理 | 会员功能开发后 |
| 营销中心 | 优惠券、促销活动 | 营销功能开发后 |
| 数据分析 | 销售报表、库存报表 | BI功能开发后 |

### 7.2 菜单与微服务演进

随着微服务拆分推进，菜单可按以下阶段更新：

```
Phase 1: IAM上线
  └── 启用平台管理下的用户/角色/权限菜单

Phase 2: 核心交易服务独立
  └── 完善订单中心菜单（核销、退款）

Phase 3: 营销会员上线
  └── 启用会员中心、营销中心菜单

Phase 4: BI服务上线
  └── 启用数据分析模块菜单
```

---

## 8. 变更记录

| 版本 | 日期 | 作者 | 变更内容 |
|------|------|------|----------|
| v1.0 | 2026-01-13 | - | 初始版本，基于微服务架构规划调整菜单结构 |

---

## 9. 相关文档

- [微服务架构拆分方案](./[todo]微服务架构拆分方案.md)
- [系统功能待开发清单](./系统功能待开发清单.md)
- [业务需求规约文档](../业务需求规约文档.md)
