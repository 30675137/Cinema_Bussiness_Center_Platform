# 零售行业解决方案白皮书

**版本**: V1.0  
**日期**: 2025-12-25  
**适用对象**: 零售行业从业者、系统开发人员、产品经理、运营管理人员

---

## 目录

1. [零售软件体系概述](#1-零售软件体系概述)
2. [核心系统划分](#2-核心系统划分)
3. [专业术语表](#3-专业术语表)
4. [核心业务流程](#4-核心业务流程)
5. [关键业务场景端到端操作](#5-关键业务场景端到端操作)
6. [产品功能列表](#6-产品功能列表)
7. [附录：系统集成架构](#7-附录系统集成架构)

---

## 1. 零售软件体系概述

### 1.1 零售行业数字化全景

零售行业的数字化转型需要构建一套完整的软件生态系统，涵盖从商品管理、库存管控、销售履约到财务核算的全链路。现代零售软件体系通常分为以下几个层次：

```
┌─────────────────────────────────────────────────────────────────┐
│                        用户触点层（Touchpoint）                   │
│    小程序 │ APP │ 官网 │ POS │ 自助终端 │ 扫码点单                 │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                        业务中台（Business Platform）              │
│   交易中心 │ 商品中心 │ 库存中心 │ 订单中心 │ 会员中心 │ 营销中心    │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                        运营后台（Operation Center）               │
│   门店管理 │ 采购管理 │ 财务对账 │ 数据报表 │ 权限管理             │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                        数据底座（Data Foundation）                │
│   主数据管理(MDM) │ 数据仓库(DW) │ 实时计算 │ 数据治理             │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 核心业务域划分

| 业务域 | 核心职责 | 典型系统 |
|-------|---------|---------|
| **商品域** | 商品主数据、类目、品牌、属性、规格、价格 | MDM/PIM系统 |
| **库存域** | 库存台账、出入库、调拨、盘点、预占 | WMS/IMS系统 |
| **交易域** | 订单、支付、履约、退换货 | OMS/TMS系统 |
| **供应链域** | 采购、供应商、物流、成本核算 | SRM/SCM系统 |
| **会员域** | 用户、会员等级、积分、权益 | CRM系统 |
| **营销域** | 促销、优惠券、活动、内容 | 营销平台 |
| **财务域** | 对账、结算、报表、成本 | ERP/财务系统 |
| **门店域** | 门店信息、排班、设备、服务 | 门店管理系统 |

---

## 2. 核心系统划分

### 2.1 主数据管理系统（MDM/PIM）

#### 系统定位
主数据管理系统是零售软件体系的"数据基石"，负责统一管理商品、类目、品牌、供应商等核心主数据，确保全渠道数据一致性。

#### 核心模块

```
主数据管理系统 (MDM/PIM)
├── 类目管理 (Category Management)
│   ├── 多级类目树维护
│   ├── 类目属性模板
│   └── 类目状态管理
├── 品牌管理 (Brand Management)
│   ├── 品牌信息维护
│   ├── 品牌授权管理
│   └── 品牌状态控制
├── 属性与数据字典 (Attribute & Dictionary)
│   ├── 属性定义（规格、参数）
│   ├── 数据字典管理
│   └── 属性模板配置
├── SPU管理 (Standard Product Unit)
│   ├── 商品基础信息
│   ├── 商品图文详情
│   └── 商品属性配置
└── SKU管理 (Stock Keeping Unit)
    ├── 规格组合管理
    ├── 条码管理
    ├── 成本与定价
    └── SKU类型划分（原料/包材/成品/套餐）
```

#### SKU四类型体系

在现代零售场景中，SKU需要支持多种类型以适应不同的业务需求：

| SKU类型 | 英文标识 | 说明 | 典型场景 |
|--------|---------|------|---------|
| **原料** | raw_material | 用于制作/调制的消耗品 | 酒液、糖浆、玉米粒 |
| **包材** | packaging | 包装材料 | 杯子、吸管、餐盒、纸袋 |
| **成品** | finished_product | 可直接售卖的商品 | 威士忌可乐、爆米花 |
| **套餐** | combo | 多个可售SKU的组合 | 观影套餐、派对套餐 |

---

### 2.2 BOM配方管理系统

#### 系统定位
BOM（Bill of Materials，物料清单）配方管理系统用于定义成品与原料/包材的组成关系，支撑现调饮品、制作类商品的库存扣减和成本核算。

#### 核心模块

```
BOM配方管理系统
├── 配方定义 (Recipe Definition)
│   ├── 父项（成品SKU）
│   ├── 子项（原料/包材SKU）
│   ├── 标准用量与单位
│   └── 损耗率配置
├── 单位换算 (Unit Conversion)
│   ├── 基础单位定义
│   ├── 换算链配置（1瓶=700ml）
│   └── 舍入规则
├── BOM版本管理 (Version Control)
│   ├── 版本号与状态
│   ├── 生效日期范围
│   └── 门店/渠道生效规则
└── 成本核算 (Cost Calculation)
    ├── 子项标准成本
    ├── 成品成本反算
    └── 毛利分析报表
```

#### 成本计算公式

```
成品标准成本 = Σ(子项用量 × 子项标准成本) × (1 + 损耗率%)

示例：威士忌可乐成本计算
- 威士忌 45ml × 0.5元/ml = 22.5元
- 可乐 150ml × 0.01元/ml = 1.5元
- 高脚杯 1个 × 2元/个 = 2元
- 吸管 1根 × 0.1元/根 = 0.1元
- 合计 = 26.1元（按5%损耗 = 27.41元）
```

---

### 2.3 库存管理系统（IMS/WMS）

#### 系统定位
库存管理系统负责实时掌控所有仓库/门店的库存状态，实现库存的可视化、可追溯和精细化管理。

#### 核心模块

```
库存管理系统
├── 库存台账 (Inventory Ledger)
│   ├── 现存库存（Physical Quantity）
│   ├── 预占库存（Reserved Quantity）
│   ├── 可用库存（Available Quantity）
│   ├── 在途库存（In-Transit Quantity）
│   └── 安全库存（Safety Stock）
├── 库存操作 (Inventory Operations)
│   ├── 入库操作（采购/调拨/盘盈/退货）
│   ├── 出库操作（销售/调拨/报损/领用）
│   ├── 报损操作（过期/破损/自然损耗）
│   └── 退库操作
├── 调拨管理 (Transfer Management)
│   ├── 调拨申请 → 审核 → 出库 → 在途 → 收货
│   └── 跨门店/仓库库存调配
├── 盘点管理 (Stocktaking)
│   ├── 盘点计划（全盘/抽盘/循环盘）
│   ├── 盘点执行（移动端扫码）
│   ├── 差异分析与审核
│   └── 库存调整
├── 库存预占 (Inventory Reservation)
│   ├── 订单预占
│   ├── 超时释放
│   ├── 取消/退款释放
│   └── 防超卖机制
└── 审计追踪 (Audit Trail)
    ├── 变动历史记录
    ├── 异常操作监控
    └── 操作人追踪
```

#### 库存计算公式

```
可用库存 = 现存库存 - 预占库存
可售库存 = 可用库存（用于前端展示）

库存状态判断：
- 低库存警告：可用库存 ≤ 安全库存（红色）
- 正常：安全库存 < 可用库存 ≤ 安全库存 × 3（绿色）
- 超库存提示：可用库存 > 安全库存 × 3（橙色）
```

---

### 2.4 场景包/套餐管理系统

#### 系统定位
场景包管理系统用于管理影院包场、主题活动等场景化服务产品，支持套餐配置、加购项管理和时段预订。

#### 核心模块

```
场景包管理系统
├── 场景包配置 (Scenario Package)
│   ├── 基础信息（名称、分类、描述、图片）
│   ├── 门店关联
│   └── 发布状态管理
├── 套餐管理 (Package Tiers)
│   ├── 多档位配置（基础/标准/豪华）
│   ├── 价格与原价
│   ├── 套餐标签
│   └── 排序管理
├── 加购项管理 (Add-on Items)
│   ├── 加购项定义
│   ├── 分类管理（餐饮/服务/布置）
│   ├── 场景包关联
│   └── 必选/可选配置
├── 时段管理 (Time Slots)
│   ├── 时段模板（按星期配置）
│   ├── 特定日期覆盖
│   ├── 库存设置
│   └── 状态计算（可预订/售罄/不可用）
└── 发布管理 (Publish Workflow)
    ├── 发布前校验
    ├── 发布/下架操作
    ├── 预览功能
    └── 状态历史记录
```

#### 场景包状态流转

```
[创建] → 草稿(DRAFT) → 发布 → 已发布(PUBLISHED) → 下架 → 草稿(DRAFT)
                                    ↓
                              已归档(ARCHIVED)
```

---

### 2.5 订单与履约系统

#### 系统定位
订单与履约系统负责管理从下单到交付的完整流程，包括订单创建、支付、库存预占、出品确认和售后处理。

#### 核心模块

```
订单与履约系统
├── 订单管理 (Order Management)
│   ├── 订单创建
│   ├── 订单状态流转
│   ├── 订单查询与筛选
│   └── 订单导出
├── 支付管理 (Payment)
│   ├── 多支付方式
│   ├── 支付状态同步
│   └── 超时取消
├── 库存预占 (Reservation)
│   ├── 下单预占
│   ├── 出品确认扣减
│   └── 取消释放
├── 出品确认 (Production Confirm)
│   ├── 手动确认
│   ├── 支付即出品（可配置）
│   └── 出品记录
└── 售后处理 (After-Sales)
    ├── 未出品退单 → 释放预占
    ├── 已出品退单 → 赠饮单/报损单
    └── 审批流程
```

---

## 3. 专业术语表

### 3.1 商品与主数据

| 术语 | 英文 | 定义 | 示例 |
|------|------|------|------|
| **SKU** | Stock Keeping Unit | 库存量单位，区分商品的最小单元 | 可口可乐330ml（红罐） |
| **SPU** | Standard Product Unit | 标准产品单元，不同规格SKU的集合 | 可口可乐（含多种规格） |
| **类目** | Category | 商品分类层级结构 | 饮料 > 碳酸饮料 > 可乐 |
| **品牌** | Brand | 商品所属品牌 | 可口可乐、百事可乐 |
| **属性** | Attribute | 商品的特征描述 | 容量、口味、包装类型 |
| **条码** | Barcode | 商品唯一识别码 | 6901939661109 |
| **原料** | Raw Material | 用于制作的基础材料 | 威士忌酒液、糖浆 |
| **包材** | Packaging | 包装材料 | 杯子、吸管、餐盒 |
| **成品** | Finished Product | 可直接售卖的商品 | 威士忌可乐 |
| **套餐** | Combo | 多个商品的组合销售 | 观影套餐 |

### 3.2 BOM与配方

| 术语 | 英文 | 定义 | 示例 |
|------|------|------|------|
| **BOM** | Bill of Materials | 物料清单，定义产品的组成结构 | 威士忌可乐配方 |
| **父项** | Parent Item | BOM中的产出成品 | 威士忌可乐 |
| **子项** | Component | BOM中的组成物料 | 威士忌、可乐、杯子 |
| **用量** | Quantity | 生产单位产品所需物料数量 | 45ml威士忌 |
| **损耗率** | Loss Rate | 生产过程中的预期损耗比例 | 5% |
| **单位换算** | Unit Conversion | 不同计量单位间的换算关系 | 1瓶 = 700ml |
| **标准成本** | Standard Cost | 预设的参考成本 | 0.5元/ml |

### 3.3 库存管理

| 术语 | 英文 | 定义 | 示例 |
|------|------|------|------|
| **库存台账** | Inventory Ledger | 特定位置特定SKU的库存状态快照 | 门店A可乐库存：50瓶 |
| **现存库存** | Physical Quantity | 实际仓库中的商品数量 | 100瓶 |
| **预占库存** | Reserved Quantity | 已被订单锁定但未出库的数量 | 30瓶 |
| **可用库存** | Available Quantity | 现存库存 - 预占库存 | 70瓶 |
| **在途库存** | In-Transit Quantity | 已采购/调拨但未到货的数量 | 50瓶 |
| **安全库存** | Safety Stock | 最低库存警戒线 | 20瓶 |
| **预占** | Reservation | 订单确认后先锁定库存 | 订单占用10瓶 |
| **调拨** | Transfer | 不同仓库/门店之间的库存转移 | 仓库A调往门店B |
| **盘点** | Stocktaking | 实地清点库存并核对账面数据 | 月度盘点 |
| **盘盈** | Stocktaking Profit | 实际库存多于账面库存 | +5瓶 |
| **盘亏** | Stocktaking Loss | 实际库存少于账面库存 | -3瓶 |
| **报损** | Write-off | 记录商品损耗 | 过期报损10瓶 |

### 3.4 订单与履约

| 术语 | 英文 | 定义 | 示例 |
|------|------|------|------|
| **订单** | Order | 客户购买请求的正式记录 | 订单号：ORD20251225001 |
| **订单行** | Order Line | 订单中的单个商品项 | 威士忌可乐 x 2 |
| **出品确认** | Production Confirm | 确认已制作/交付，触发实际扣减 | 吧台确认出品 |
| **赠饮单** | Complimentary Order | 客诉补偿/活动赠送的记录单据 | 赠饮1杯 |
| **报损单** | Waste Order | 制作失败/过期等损耗的记录单据 | 报损1杯 |

### 3.5 场景包与预订

| 术语 | 英文 | 定义 | 示例 |
|------|------|------|------|
| **场景包** | Scenario Package | 可预订的场地服务组合 | 企业年会专场 |
| **套餐档位** | Package Tier | 场景包下的价格档位 | 基础/标准/豪华 |
| **加购项** | Add-on Item | 可额外购买的增值服务 | 高端茶歇 |
| **时段** | Time Slot | 可预订的具体时间段 | 10:00-13:00 |
| **发布** | Publish | 将场景包状态变为上架可售 | 发布上线 |
| **下架** | Unpublish | 将场景包变为不可售 | 临时下架 |

---

## 4. 核心业务流程

### 4.1 商品主数据管理流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                         商品主数据管理流程                            │
└─────────────────────────────────────────────────────────────────────┘

[类目规划]    [品牌准入]    [属性模板]
    │             │             │
    └──────┬──────┴──────┬──────┘
           │             │
           ▼             ▼
      ┌─────────────────────────┐
      │   创建SPU（商品主体）    │
      │  - 商品名称、描述        │
      │  - 类目、品牌关联        │
      │  - 商品图片、详情        │
      └───────────┬─────────────┘
                  │
                  ▼
      ┌─────────────────────────┐
      │   创建SKU（规格单元）    │
      │  - 规格组合              │
      │  - 条码、成本、定价      │
      │  - SKU类型              │
      └───────────┬─────────────┘
                  │
                  ▼
      ┌─────────────────────────┐
      │     审核与上架           │
      │  - 信息完整性校验        │
      │  - 状态：草稿→启用       │
      └───────────┬─────────────┘
                  │
                  ▼
         [同步至销售渠道]
```

### 4.2 BOM配方管理流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                         BOM配方管理流程                              │
└─────────────────────────────────────────────────────────────────────┘

[原料/包材SKU]    [单位换算配置]    [成品SKU]
    │                  │               │
    └────────┬─────────┴───────┬───────┘
             │                 │
             ▼                 ▼
      ┌─────────────────────────────────┐
      │         创建BOM配方              │
      │  1. 选择父项（成品SKU）          │
      │  2. 添加子项（原料+包材）        │
      │  3. 设置用量与单位              │
      │  4. 配置损耗率                  │
      └───────────────┬─────────────────┘
                      │
                      ▼
      ┌─────────────────────────────────┐
      │          单位换算校验            │
      │  - 检查换算链是否存在           │
      │  - 验证用量合理性               │
      └───────────────┬─────────────────┘
                      │
                      ▼
      ┌─────────────────────────────────┐
      │          成本自动计算            │
      │  成品成本 = Σ(子项用量×单价)    │
      │           × (1+损耗率)          │
      └───────────────┬─────────────────┘
                      │
                      ▼
      ┌─────────────────────────────────┐
      │        BOM版本与生效            │
      │  - 设置版本号与状态             │
      │  - 配置生效门店/渠道            │
      │  - 启用生效                    │
      └─────────────────────────────────┘
```

### 4.3 库存预占与出品流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                        库存预占与出品流程                            │
└─────────────────────────────────────────────────────────────────────┘

        [客户下单]
             │
             ▼
    ┌─────────────────┐
    │   创建订单       │
    │ 订单状态：待确认  │
    └────────┬────────┘
             │
             ▼
    ┌─────────────────┐     ┌─────────────────┐
    │   库存可用检查   │ ──▶ │ 库存不足，阻止下单│
    │ 按BOM展开计算    │     └─────────────────┘
    └────────┬────────┘
             │ 库存充足
             ▼
    ┌─────────────────┐
    │   库存预占       │
    │ - 扣减可用库存   │
    │ - 增加预占库存   │
    │ - 记录预占明细   │
    └────────┬────────┘
             │
             ▼
    ┌─────────────────┐
    │   支付确认       │
    │ 订单状态：已支付  │
    └────────┬────────┘
             │
             ▼
    ┌─────────────────┐
    │   出品确认       │
    │ - 预占转实际扣减 │
    │ - 生成出品记录   │
    │ 订单状态：已完成  │
    └────────┬────────┘
             │
             ▼
        [订单完成]
```

### 4.4 退单处理流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                          退单处理流程                                │
└─────────────────────────────────────────────────────────────────────┘

              [申请退单]
                   │
                   ▼
          ┌───────────────────┐
          │   判断出品状态     │
          └─────────┬─────────┘
                    │
        ┌───────────┴───────────┐
        │                       │
        ▼                       ▼
  [未出品]                    [已出品]
        │                       │
        ▼                       ▼
┌───────────────┐      ┌───────────────────┐
│ 释放库存预占   │      │  选择处理方式      │
│ - 恢复可用库存 │      │ ① 赠饮（客诉补偿）│
│ - 减少预占库存 │      │ ② 报损（质量问题）│
└───────┬───────┘      └─────────┬─────────┘
        │                        │
        ▼                        ▼
  [退款处理]              ┌───────────────────┐
                         │ 生成赠饮/报损单    │
                         │ - 记录原因        │
                         │ - 关联订单        │
                         │ - 库存不回滚      │
                         └─────────┬─────────┘
                                   │
                                   ▼
                         ┌───────────────────┐
                         │  审批流程（可选）  │
                         │ 超阈值需审批      │
                         └─────────┬─────────┘
                                   │
                                   ▼
                            [退款处理]
```

### 4.5 库存盘点流程

```
┌─────────────────────────────────────────────────────────────────────┐
│                          库存盘点流程                                │
└─────────────────────────────────────────────────────────────────────┘

  [创建盘点计划]
        │
        │  - 选择盘点类型（全盘/抽盘/循环盘）
        │  - 选择盘点范围（仓库/门店/类目）
        │  - 分配执行人员
        │
        ▼
  [执行盘点]
        │
        │  - 扫码录入商品
        │  - 记录实盘数量
        │  - 拍照记录（可选）
        │
        ▼
  [差异计算]
        │
        │  差异 = 实盘数量 - 账面数量
        │  盘盈：差异 > 0
        │  盘亏：差异 < 0
        │
        ▼
  [选择差异原因]
        │
        │  盘亏原因：未登记赠饮、溢洒、盗损
        │  盘盈原因：未登记入库、系统错误
        │
        ▼
  [审核确认]
        │
        │  差异率 < 5%：自动通过
        │  差异率 5-10%：主管审核
        │  差异率 > 10%：高层审批/重新盘点
        │
        ▼
  [库存调整]
        │
        │  审批通过后自动调整账面库存
        │  生成调整日志和审计记录
        │
        ▼
  [盘点完成]
```

---

## 5. 关键业务场景端到端操作

### 5.1 场景一：酒吧现调饮品售卖

**业务背景**：顾客在吧台点一杯"威士忌可乐"，吧台员工制作并交付。

#### 前置条件配置

| 配置项 | 具体内容 |
|-------|---------|
| 原料SKU | 威士忌（库存单位：ml）、可乐（库存单位：ml） |
| 包材SKU | 高脚杯（库存单位：个）、吸管（库存单位：根） |
| 成品SKU | 威士忌可乐（售价：48元） |
| BOM配方 | 威士忌45ml + 可乐150ml + 高脚杯1个 + 吸管1根 |
| 单位换算 | 1瓶威士忌 = 700ml |
| 吧台库存 | 威士忌1400ml(2瓶)、可乐3000ml、高脚杯50个、吸管100根 |

#### 端到端操作步骤

| 步骤 | 操作 | 系统响应 | 库存变化 |
|-----|------|---------|---------|
| 1 | 收银员在小程序/POS下单：威士忌可乐×1 | 订单创建成功，生成订单号 | 无变化 |
| 2 | 系统按BOM计算物料需求 | 自动展开：威士忌45ml、可乐150ml、杯1、管1 | 无变化 |
| 3 | 订单确认，系统执行库存预占 | 预占成功 | 可用库存减少 |
| 4 | 查看库存状态 | 威士忌：总量1400/可用1355/预占45 | 预占锁定 |
| 5 | 吧台员工点击"出品确认" | 预占转实际扣减，生成出品记录 | 总量减少 |
| 6 | 查看最终库存 | 威士忌：总量1355/可用1355/预占0 | 扣减完成 |

#### 异常处理场景

**场景A：库存不足**
```
操作：下单威士忌可乐×20
系统响应：预占时提示"威士忌库存不足，当前可用900ml，需900ml，请补货"
处理：取消订单或减少数量
```

**场景B：出品前取消**
```
操作：订单确认后、出品前取消订单
系统响应：释放预占库存
结果：可用库存恢复，无实际消耗
```

**场景C：已出品退单（客诉）**
```
操作：已出品后顾客投诉口味不对
系统响应：选择"客诉补偿→赠饮"，必须选择原因
结果：生成赠饮单，库存不回滚，记录可追溯
```

---

### 5.2 场景二：主仓领用补货

**业务背景**：吧台威士忌库存告警，需从主仓领用补货。

#### 端到端操作步骤

| 步骤 | 角色 | 操作 | 系统状态 |
|-----|------|------|---------|
| 1 | 仓管 | 创建领用单：威士忌×3瓶 | 单据状态：草稿 |
| 2 | 仓管 | 提交领用单 | 单据状态：待出库 |
| 3 | 仓管 | 扫码确认出库 | 单据状态：在途 |
| 4 | - | 主仓库存变化 | 主仓：减少3瓶（2100ml） |
| 5 | 吧台 | 扫码确认入库 | 单据状态：已完成 |
| 6 | - | 吧台库存变化 | 吧台：增加2100ml |
| 7 | 查看 | 查看单据追溯 | 记录：创建人、出库人、入库人、时间 |

---

### 5.3 场景三：吧台月度盘点

**业务背景**：月末盘点，发现威士忌实际库存与系统不符。

#### 端到端操作步骤

| 步骤 | 操作 | 系统响应 |
|-----|------|---------|
| 1 | 创建盘点计划：吧台库-酒水类 | 生成盘点任务单 |
| 2 | 移动端扫码录入实盘数量 | 系统库存1400ml，实盘1200ml |
| 3 | 系统自动计算差异 | 差异：-200ml（盘亏14.3%） |
| 4 | 选择差异原因 | 勾选"计量误差"+"溢洒"，必须选择 |
| 5 | 提交盘点单 | 生成差异单，库存暂不变动 |
| 6 | 店长审批 | 录入审批意见 |
| 7 | 审批通过 | 库存调整为1200ml |
| 8 | 查看差异报表 | 本月盘亏汇总、原因分布 |

---

### 5.4 场景四：场景包预订（企业年会）

**业务背景**：企业客户预订影院包场举办年会活动。

#### 前置条件配置

| 配置项 | 具体内容 |
|-------|---------|
| 场景包 | 企业年会专场（状态：已发布） |
| 套餐档位 | 基础版3888元、标准版5888元、豪华版8888元 |
| 加购项 | 高端茶歇58元/份、鲜花布置388元、摄影服务888元 |
| 时段 | 10:00-13:00、14:00-17:00、18:00-21:00 |
| 库存 | 每时段1个名额 |

#### 端到端操作步骤（C端用户视角）

| 步骤 | 操作 | 系统响应 |
|-----|------|---------|
| 1 | 打开小程序，浏览场景包列表 | 显示所有已发布的场景包 |
| 2 | 选择"企业年会专场" | 进入详情页，显示套餐、加购项 |
| 3 | 选择日期：2025-12-28 | 加载当日可预订时段 |
| 4 | 选择时段：14:00-17:00 | 显示"可预订"（剩余1个） |
| 5 | 选择套餐：标准版（5888元） | 总价更新为5888元 |
| 6 | 添加加购：高端茶歇×20份 | 总价更新为5888+1160=7048元 |
| 7 | 添加加购：摄影服务×1 | 总价更新为7048+888=7936元 |
| 8 | 提交订单 | 时段库存预占，订单创建成功 |
| 9 | 完成支付 | 订单状态：已支付，等待活动日 |

#### 端到端操作步骤（B端运营视角）

| 步骤 | 操作 | 系统响应 |
|-----|------|---------|
| 1 | 登录运营后台 | 进入场景包管理 |
| 2 | 创建场景包，填写基础信息 | 状态：草稿 |
| 3 | 配置套餐档位 | 添加3个套餐 |
| 4 | 关联加购项 | 选择可用加购项，设置排序 |
| 5 | 配置时段模板 | 设置周一至周五3个时段 |
| 6 | 点击"发布" | 系统校验：✓基础信息 ✓套餐 ✓时段 |
| 7 | 发布成功 | 状态变为"已发布"，C端可见 |

---

### 5.5 场景五：成本与毛利分析

**业务背景**：财务查看"威士忌可乐"的成本结构和日销毛利。

#### 端到端操作步骤

| 步骤 | 操作 | 系统响应 |
|-----|------|---------|
| 1 | 维护原料标准成本 | 威士忌=0.5元/ml，可乐=0.01元/ml |
| 2 | 维护包材标准成本 | 高脚杯=2元/个，吸管=0.1元/根 |
| 3 | 查看BOM成本明细 | 自动计算显示 |
| 4 | 成品成本反算 | 45×0.5+150×0.01+2+0.1=26.1元 |
| 5 | 设置成品售价 | 威士忌可乐=48元 |
| 6 | 查看单品毛利 | 毛利=48-26.1=21.9元，毛利率=45.6% |
| 7 | 查看日毛利报表 | 日销10杯：销售额480元，成本261元，毛利219元 |
| 8 | 按门店筛选 | 对比不同门店毛利表现 |

---

## 6. 产品功能列表

> **状态说明**: ✅ 已实现 | 🟡 部分实现 | 🔴 未实现

### 6.1 商品管理系统 (MDM/PIM)

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **类目管理** | 类目CRUD | ✅ | 多级树形结构 |
| | 类目层级维护 | ✅ | 支持3级层级 |
| | 类目状态管理 | ✅ | 启用/禁用 |
| | 类目属性关联 | 🟡 | 基础关联已实现 |
| **品牌管理** | 品牌CRUD | ✅ | 完整CRUD |
| | 品牌Logo管理 | ✅ | 图片上传 |
| | 品牌状态管理 | ✅ | 启用/禁用 |
| | 品牌授权管理 | 🔴 | 待开发 |
| **属性与数据字典** | 数据字典管理 | ✅ | 颜色、尺码等 |
| | 属性模板配置 | ✅ | 规格属性定义 |
| | 属性继承机制 | 🟡 | SPU→SKU继承 |
| | 动态属性扩展 | 🔴 | 待开发 |
| **SPU管理** | SPU CRUD | ✅ | 完整CRUD |
| | 商品图文维护 | ✅ | 图片+描述 |
| | 产品类型划分 | ✅ | 4种类型 |
| | 商品状态管理 | ✅ | 草稿/启用/禁用 |
| | 批量操作 | 🔴 | 批量上下架 |
| **SKU管理** | SKU CRUD | ✅ | 完整CRUD |
| | 规格组合管理 | ✅ | 多规格笛卡尔积 |
| | 条码管理 | ✅ | 自动生成/手工录入 |
| | 成本与定价 | ✅ | 采购价/零售价 |
| | SKU四类型划分 | ✅ | 原料/包材/成品/套餐 |
| | SKU编码自动生成 | ✅ | 按规则生成 |
| | 批量导入导出 | 🔴 | 待开发 |

### 6.2 BOM/配方管理系统

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **配方定义** | BOM CRUD | ✅ | 父项+子项配置 |
| | 组件用量配置 | ✅ | 数量+单位 |
| | 损耗率配置 | ✅ | 百分比损耗 |
| | BOM展开计算 | 🟡 | 基础展开已实现 |
| | 多级BOM嵌套 | 🔴 | 待开发 |
| **单位换算** | 换算规则CRUD | ✅ | 瓶↔ml等 |
| | 换算链支持 | ✅ | 多级链路 |
| | 双向换算 | ✅ | A→B和B→A |
| | 循环依赖检测 | ✅ | DFS检测 |
| | 最短路径计算 | ✅ | BFS算法 |
| | 舍入规则配置 | 🟡 | 按类型配置 |
| **BOM版本管理** | 版本号管理 | 🔴 | 待开发 |
| | 生效日期范围 | 🔴 | 待开发 |
| | 门店/渠道生效 | 🔴 | 待开发 |
| **成本核算** | 成品成本计算 | 🟡 | 基础计算 |
| | 毛利分析 | 🔴 | 待开发 |
| | 成本报表 | 🔴 | 待开发 |

### 6.3 库存管理系统 (IMS)

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **库存台账** | 台账查看 | ✅ | 按门店/仓库 |
| | 多维筛选 | ✅ | SKU/类目/状态 |
| | 可用库存计算 | ✅ | 现存-预占 |
| | 库存预警 | 🟡 | 低库存提示 |
| | 安全库存配置 | 🔴 | 待开发 |
| **入库管理** | 采购入库 | 🟡 | 基础功能 |
| | 调拨入库 | 🔴 | 待开发 |
| | 盘盈入库 | 🔴 | 待开发 |
| | 退货入库 | 🔴 | 待开发 |
| **出库管理** | 销售出库 | 🟡 | 订单扣减 |
| | 调拨出库 | 🔴 | 待开发 |
| | 报损出库 | 🔴 | 待开发 |
| | 领用出库 | 🔴 | 待开发 |
| **库存预占** | 订单预占 | 🔴 | 待开发 |
| | 预占释放 | 🔴 | 待开发 |
| | 超时自动释放 | 🔴 | 待开发 |
| **调拨管理** | 调拨申请 | 🔴 | 待开发 |
| | 调拨审批 | 🔴 | 待开发 |
| | 在途追踪 | 🔴 | 待开发 |
| **盘点管理** | 盘点计划 | 🔴 | 待开发 |
| | 盘点执行 | 🔴 | 待开发 |
| | 差异分析 | 🔴 | 待开发 |
| | 盘点审批 | 🔴 | 待开发 |
| **审计追踪** | 变动历史 | 🔴 | 待开发 |
| | 操作日志 | 🔴 | 待开发 |

### 6.4 场景包/套餐管理系统

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **场景包管理** | 场景包CRUD | ✅ | 完整CRUD |
| | 基础信息配置 | ✅ | 名称/描述/图片 |
| | 门店关联 | ✅ | 多门店绑定 |
| | 分类管理 | 🟡 | 基础分类 |
| **套餐档位** | 套餐CRUD | ✅ | 多档位配置 |
| | 价格配置 | ✅ | 原价/现价 |
| | 套餐标签 | ✅ | 热销/推荐 |
| | 排序管理 | ✅ | 拖拽排序 |
| **加购项管理** | 加购项CRUD | ✅ | 完整CRUD |
| | 分类配置 | ✅ | 餐饮/服务/布置 |
| | 场景包关联 | ✅ | 多对多 |
| | 必选/可选 | 🟡 | 基础配置 |
| **时段管理** | 时段模板 | ✅ | 按星期配置 |
| | 特定日期覆盖 | 🔴 | 待开发 |
| | 库存设置 | ✅ | 时段库存 |
| | 状态计算 | ✅ | 可订/售罄 |
| **发布管理** | 发布操作 | ✅ | 草稿→发布 |
| | 发布前校验 | ✅ | 完整性检查 |
| | 下架操作 | ✅ | 发布→草稿 |
| | 预览功能 | 🔴 | 待开发 |

### 6.5 采购与供应链系统

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **供应商管理** | 供应商CRUD | ✅ | 完整CRUD |
| | 供应商分类 | ✅ | 多级分类 |
| | 联系信息 | ✅ | 地址/电话 |
| | 资质管理 | 🔴 | 证照上传 |
| | 供应商评级 | 🔴 | 待开发 |
| **采购订单** | 采购单创建 | 🟡 | 基础创建 |
| | 订单审批 | 🔴 | 待开发 |
| | 订单跟踪 | 🔴 | 待开发 |
| | 到货入库 | 🟡 | 基础入库 |
| | 采购退货 | 🔴 | 待开发 |
| **采购计划** | 补货建议 | 🔴 | 智能补货 |
| | 采购计划生成 | 🔴 | 待开发 |
| | 预算管理 | 🔴 | 待开发 |

### 6.6 订单与履约系统

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **订单管理** | 订单创建 | 🟡 | C端下单 |
| | 订单查询 | ✅ | 列表/筛选 |
| | 订单详情 | ✅ | 详情查看 |
| | 订单状态流转 | 🟡 | 基础状态 |
| | 订单导出 | 🔴 | 待开发 |
| **预约订单** | 预约管理 | ✅ | 场景包预约 |
| | 预约日历 | 🔴 | 待开发 |
| | 预约提醒 | 🔴 | 待开发 |
| **支付管理** | 微信支付 | 🔴 | 待对接 |
| | 支付状态同步 | 🔴 | 待开发 |
| | 退款处理 | 🔴 | 待开发 |
| **出品管理** | 出品确认 | 🔴 | 待开发 |
| | 出品记录 | 🔴 | 待开发 |
| | 吧台工作台 | 🔴 | 待开发 |
| **售后处理** | 退单申请 | 🔴 | 待开发 |
| | 赠饮单 | 🔴 | 待开发 |
| | 报损单 | 🔴 | 待开发 |

### 6.7 门店与资源管理系统

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **门店管理** | 门店CRUD | ✅ | 完整CRUD |
| | 门店地址 | ✅ | 地理位置 |
| | 门店状态 | ✅ | 营业/休息 |
| | 营业时间 | 🟡 | 基础配置 |
| | 门店标签 | 🔴 | 待开发 |
| **影厅管理** | 影厅CRUD | ✅ | 完整CRUD |
| | 座位配置 | 🟡 | 基础配置 |
| | 影厅设备 | 🔴 | 待开发 |
| **预约设置** | 预约时段配置 | ✅ | 时段模板 |
| | 预约规则 | 🟡 | 基础规则 |
| | 黑名单管理 | 🔴 | 待开发 |
| **活动类型** | 活动类型CRUD | ✅ | 完整CRUD |
| | 活动模板 | 🔴 | 待开发 |

### 6.8 运营报表系统

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **销售报表** | 日销报表 | 🔴 | 待开发 |
| | 商品销量排行 | 🔴 | 待开发 |
| | 门店业绩对比 | 🔴 | 待开发 |
| | 时段分析 | 🔴 | 待开发 |
| **库存报表** | 库存周转 | 🔴 | 待开发 |
| | 库龄分析 | 🔴 | 待开发 |
| | 呆滞库存 | 🔴 | 待开发 |
| | 盘点差异 | 🔴 | 待开发 |
| **成本报表** | 成本分析 | 🔴 | 待开发 |
| | 毛利分析 | 🔴 | 待开发 |
| | 损耗统计 | 🔴 | 待开发 |
| **运营看板** | 实时看板 | 🔴 | 待开发 |
| | KPI指标 | 🔴 | 待开发 |
| | 异常预警 | 🔴 | 待开发 |

### 6.9 系统管理

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **用户管理** | 用户CRUD | 🟡 | 基础功能 |
| | 角色管理 | 🔴 | 待开发 |
| | 权限配置 | 🔴 | 待开发 |
| **组织架构** | 部门管理 | 🔴 | 待开发 |
| | 岗位管理 | 🔴 | 待开发 |
| **系统设置** | 参数配置 | 🔴 | 待开发 |
| | 字典管理 | ✅ | 数据字典 |
| | 日志管理 | 🔴 | 待开发 |
| **微信登录** | 小程序登录 | ✅ | 微信授权 |
| | 会话管理 | ✅ | Token管理 |

### 6.10 C端小程序

| 模块 | 功能 | 状态 | 说明 |
|------|------|:----:|------|
| **首页** | 场景包展示 | ✅ | 列表展示 |
| | 门店选择 | ✅ | 多门店 |
| | 搜索功能 | 🔴 | 待开发 |
| **场景包详情** | 详情展示 | ✅ | 图文介绍 |
| | 套餐选择 | ✅ | 多档位 |
| | 加购项选择 | ✅ | 可选加购 |
| | 时段选择 | ✅ | 日期+时段 |
| **预约下单** | 下单流程 | ✅ | 完整流程 |
| | 订单确认 | ✅ | 信息确认 |
| | 微信支付 | 🔴 | 待对接 |
| **个人中心** | 用户信息 | 🟡 | 基础信息 |
| | 订单列表 | ✅ | 我的订单 |
| | 订单详情 | ✅ | 详情查看 |

### 功能统计

| 系统 | 已实现 | 部分实现 | 未实现 | 总计 | 完成度 |
|------|:------:|:--------:|:------:|:----:|:------:|
| 商品管理 (MDM/PIM) | 16 | 2 | 4 | 22 | 77% |
| BOM/配方管理 | 7 | 3 | 6 | 16 | 53% |
| 库存管理 (IMS) | 3 | 4 | 17 | 24 | 21% |
| 场景包/套餐管理 | 15 | 2 | 2 | 19 | 84% |
| 采购与供应链 | 3 | 2 | 8 | 13 | 31% |
| 订单与履约 | 4 | 3 | 11 | 18 | 31% |
| 门店与资源管理 | 6 | 3 | 4 | 13 | 58% |
| 运营报表 | 0 | 0 | 12 | 12 | 0% |
| 系统管理 | 3 | 1 | 5 | 9 | 39% |
| C端小程序 | 9 | 1 | 3 | 13 | 73% |
| **总计** | **66** | **21** | **72** | **159** | **55%** |

---

## 7. 附录：系统集成架构

### 6.1 系统集成总览

```
┌─────────────────────────────────────────────────────────────────────┐
│                           前端应用层                                 │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐            │
│  │ B端后台  │  │ C端小程序 │  │ POS终端  │  │ 吧台终端 │            │
│  │(React)   │  │ (Taro)   │  │          │  │          │            │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘            │
└───────┼─────────────┼─────────────┼─────────────┼───────────────────┘
        │             │             │             │
        └──────────────┴──────────────┴──────────────┘
                              │
                        RESTful API
                              │
┌─────────────────────────────────────────────────────────────────────┐
│                          API网关层                                   │
│  认证授权 │ 限流 │ 日志 │ 路由                                       │
└───────────────────────────────┬─────────────────────────────────────┘
                                │
┌───────────────────────────────┴─────────────────────────────────────┐
│                          业务服务层                                  │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │
│  │ 商品服务    │ │ 库存服务    │ │ 订单服务    │ │ 场景包服务   │   │
│  │ ProductSvc  │ │ InventorySvc│ │ OrderSvc   │ │ PackageSvc  │   │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │
│  │ BOM服务     │ │ 盘点服务    │ │ 会员服务    │ │ 报表服务     │   │
│  │ BOMSvc     │ │ StocktakeSvc│ │ MemberSvc  │ │ ReportSvc   │   │
│  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │
└───────────────────────────────┬─────────────────────────────────────┘
                                │
┌───────────────────────────────┴─────────────────────────────────────┐
│                          数据持久层                                  │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                    Supabase (PostgreSQL)                     │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐        │   │
│  │  │ 商品表   │ │ 库存表   │ │ 订单表   │ │ 配方表   │        │   │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘        │   │
│  └─────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────┘
```

### 6.2 核心数据流

```
商品创建流程:
MDM/PIM → 商品服务 → 数据库 → 同步库存初始化

订单创建流程:
C端/POS → 订单服务 → 库存服务(预占) → BOM服务(展开) → 数据库

出品扣减流程:
吧台终端 → 订单服务 → 库存服务(扣减) → 审计日志 → 数据库

盘点调整流程:
盘点录入 → 差异计算 → 审批流程 → 库存调整 → 审计日志
```

### 6.3 技术栈参考

| 层次 | 技术选型 |
|------|---------|
| 前端B端 | React + Ant Design + TanStack Query |
| 前端C端 | Taro + React |
| 后端服务 | Spring Boot 3.x |
| 数据库 | Supabase (PostgreSQL) |
| 缓存 | Spring Cache (Memory) |
| API规范 | RESTful + JWT认证 |

---

## 文档更新记录

| 版本 | 日期 | 更新内容 | 作者 |
|-----|------|---------|------|
| V1.0 | 2025-12-25 | 初始版本 | 系统生成 |
| V1.1 | 2025-12-25 | 新增产品功能列表章节 | 系统生成 |

---

**文档结束**
