# 原料SKU与辅助单位配置指南

> **文档版本**: v1.0  
> **创建日期**: 2026-01-11  
> **适用范围**: 影院商品运营中心 - 采购与库存管理模块

---

## 概述

本文档以**朗姆酒**为例，详细说明如何配置原料SKU、单位换算规则、辅助单位，以及如何在采购订单和BOM配方中正确使用这些配置。

### 典型场景

| 场景要素 | 说明 |
|---------|------|
| 原料名称 | 朗姆酒 |
| 规格 | 500ml/瓶 |
| 采购方式 | 按"瓶"购买 |
| BOM用途 | 制作鸡尾酒，每份需要50ml |
| 库存管理 | 以ml为主单位（便于精确扣减） |

---

## 一、配置单位换算规则

### 1.1 进入路径

`系统设置 → 单位换算管理` 或直接访问 `/bom/conversion`

### 1.2 添加换算规则

点击「新增换算规则」按钮，填写以下信息：

| 字段 | 值 | 说明 |
|------|-----|------|
| 源单位 | `瓶` | 采购/包装单位 |
| 目标单位 | `ml` | 库存/计量单位 |
| 换算率 | `500` | 1瓶 = 500ml |
| 单位类别 | `体积 (volume)` | 用于舍入精度控制 |

### 1.3 换算预览

系统会实时显示换算预览：

```
1 瓶 → 500 ml
```

### 1.4 换算链路支持

系统支持多级换算链路计算。例如配置以下规则后：

| 源单位 | 目标单位 | 换算率 |
|--------|----------|--------|
| 瓶 | ml | 500 |
| ml | L | 0.001 |

系统能自动计算：`1 瓶 = 0.5 L`

### 1.5 循环依赖检测

系统会自动检测换算规则是否形成循环（如 A→B→C→A），如检测到循环将阻止保存并提示循环路径。

---

## 二、创建原料 SKU

### 2.1 进入路径

`商品管理 → SKU管理 → 新建SKU`

### 2.2 先创建原料 SPU（必须步骤）

由于系统要求所有 SKU 必须关联 SPU，需要先创建原料的 SPU：

**进入路径**：`商品管理 → SPU管理 → 新建SPU`

| 字段 | 值 | 说明 |
|------|-----|------|
| SPU编码 | `SPU-RUM-001` | SPU 编码 |
| SPU名称 | `朗姆酒` | |
| 品牌 | 百加得 | 可选 |
| 分类 | 酒类/烈酒 | |
| 状态 | 启用 | |

### 2.3 创建原料 SKU

**进入路径**：`商品管理 → SKU管理 → 新建SKU`

| 字段 | 值 | 说明 |
|------|-----|------|
| 所属SPU | `朗姆酒 (SPU-RUM-001)` | 选择刚创建的 SPU |
| SKU编码 | `RAW-RUM-001` | 原料类型建议以 RAW- 开头 |
| SKU名称 | `朗姆酒500ml` | |
| SKU类型 | `原料 (RAW_MATERIAL)` | |
| 状态 | 启用 | |

> **说明**：当前系统要求所有 SKU（包括原料类型）都必须关联 SPU。SPU 用于商品分类管理，SKU 用于库存和成本管理。

### 2.4 单位与条码配置（关键步骤）

#### 2.3.1 主库存单位

选择 `ml` 作为主库存单位。

**选择依据**：
- 主库存单位是库存管理和BOM扣减的基础单位
- 使用ml可以支持BOM配方的精确扣减（如每份50ml）
- 避免因整瓶不可分割导致的计算困难

#### 2.3.2 配置辅助单位（销售单位）

点击「添加销售单位」按钮，配置采购用的辅助单位：

| 字段 | 值 | 说明 |
|------|-----|------|
| 销售单位 | `瓶` | 采购时使用的单位 |
| 换算关系 | `500` | 1瓶 = 500ml（与换算规则一致） |
| 状态 | 启用 | |

**界面示意**：

```
┌─────────────────────────────────────────────────┐
│ 单位与条码配置                                    │
├─────────────────────────────────────────────────┤
│ 主库存单位：[ ml ▼]                              │
│                                                 │
│ 销售单位配置：                                    │
│ ┌──────────┬────────────┬────────┐              │
│ │ 销售单位  │  换算关系   │  状态  │              │
│ │ [ 瓶 ▼]  │   [ 500 ]  │ [启用] │  [删除]      │
│ └──────────┴────────────┴────────┘              │
│ [+ 添加销售单位]                                  │
│                                                 │
│ 主条码：[ 6901234567890 ]                        │
└─────────────────────────────────────────────────┘
```

#### 2.3.3 条码配置

填写商品的主条码（如EAN-13格式）。

### 2.5 成本信息配置（可选）

| 字段 | 值 | 说明 |
|------|-----|------|
| 标准成本 | `0.24` | 元/ml（120元÷500ml） |
| 成本单位 | `ml` | 与主库存单位一致 |

---

## 三、创建采购订单

### 3.1 进入路径

`采购管理 → 创建采购订单`

### 3.2 填写订单基本信息

| 字段 | 示例值 | 说明 |
|------|--------|------|
| 供应商 | 酒类供应商A | 从供应商列表选择 |
| 目标门店 | 万达店 | 从门店列表选择 |
| 计划到货日期 | 2026-01-15 | 可选 |
| 备注 | 月度补货 | 可选 |

### 3.3 添加采购商品

1. 点击「添加采购商品」按钮
2. 在SKU选择器中搜索 `RAW-RUM-001` 或 `朗姆酒`
3. 选中商品后添加到采购明细

### 3.4 填写采购数量与单价

| 字段 | 值 | 说明 |
|------|-----|------|
| SKU编码 | RAW-RUM-001 | 自动填充 |
| 商品名称 | 朗姆酒 | 自动填充 |
| 单位 | 瓶 | 使用辅助单位显示 |
| 采购数量 | 10 | 按瓶采购 |
| 采购单价 | 120.00 | 元/瓶 |
| 行小计 | 1,200.00 | 自动计算 |

### 3.5 系统自动换算

当采购订单收货入库时，系统会自动进行单位换算：

| 采购数量 | 换算规则 | 入库数量 |
|---------|----------|---------|
| 10 瓶 | 1瓶 = 500ml | 5,000 ml |

---

## 四、配置 BOM 配方

### 4.1 场景说明

以**莫吉托鸡尾酒**为例，配置BOM配方。

### 4.2 进入路径

`商品管理 → BOM配方管理`

### 4.3 选择成品SKU

选择或创建成品SKU：`FIN-MOJITO-001 莫吉托鸡尾酒`

### 4.4 添加原料组件

| 原料SKU | 原料名称 | 数量 | 单位 |
|---------|----------|------|------|
| RAW-RUM-001 | 朗姆酒 | 50 | ml |
| RAW-LIME-001 | 青柠 | 2 | 片 |
| RAW-MINT-001 | 薄荷叶 | 5 | 片 |
| RAW-SUGAR-001 | 白砂糖 | 10 | g |
| RAW-SODA-001 | 苏打水 | 100 | ml |

### 4.5 库存扣减示意

售出1份莫吉托后，库存变化：

```
售出 1 份莫吉托鸡尾酒
├── 朗姆酒库存：5000ml → 4950ml （扣减 50ml）
├── 青柠库存：20片 → 18片 （扣减 2片）
├── 薄荷叶库存：50片 → 45片 （扣减 5片）
├── 白砂糖库存：500g → 490g （扣减 10g）
└── 苏打水库存：2000ml → 1900ml （扣减 100ml）
```

---

## 五、数据流向示意图

```
采购入库（按瓶）                库存管理（按ml）              BOM扣减（按ml）
     │                              │                           │
     │  采购 10 瓶                   │                           │
     │  (10 × 500 = 5000ml)         │                           │
     ▼                              ▼                           ▼
┌─────────────┐    换算规则    ┌─────────────┐    配方消耗   ┌─────────────┐
│ 采购订单    │ ─────────────→ │ 库存台账    │ ───────────→ │ BOM配方     │
│             │   1瓶=500ml    │             │   50ml/份    │             │
│ 10 瓶       │                │ 5000 ml     │              │ 每份50ml    │
│ @120元/瓶   │                │             │              │             │
└─────────────┘                └─────────────┘              └─────────────┘
```

---

## 六、两种采购方式对比

### 方式一：直接使用主单位采购

**操作方式**：采购时直接输入ml数量

| 优点 | 缺点 |
|------|------|
| 配置简单，无需设置辅助单位 | 需要手动计算（10瓶 = 5000ml） |
| | 与供应商沟通不便 |
| | 容易出错 |

**适用场景**：简单原料，无标准包装规格

### 方式二：使用辅助单位采购（推荐）

**操作方式**：配置辅助单位后，采购时输入瓶数

| 优点 | 缺点 |
|------|------|
| 符合实际采购习惯 | 需要预先配置换算规则和辅助单位 |
| 与供应商沟通方便 | |
| 系统自动换算，减少出错 | |
| 成本核算清晰（按瓶计价） | |

**适用场景**：有标准包装规格的原料（瓶装、袋装、箱装等）

---

## 七、注意事项

### 7.1 配置顺序

```
1. 配置单位换算规则（瓶→ml）
       ↓
2. 创建原料SKU（配置主单位ml + 辅助单位瓶）
       ↓
3. 创建采购订单（使用辅助单位采购）
       ↓
4. 配置BOM配方（使用主单位配置用量）
```

### 7.2 换算关系一致性

SKU中配置的换算关系**必须**与全局换算规则保持一致：

| 配置位置 | 换算关系 |
|---------|---------|
| 单位换算管理 | 1瓶 = 500ml |
| SKU辅助单位 | 换算关系 = 500 |

### 7.3 精度处理规则

不同类别的单位有不同的默认舍入精度：

| 单位类别 | 默认精度 | 示例 |
|---------|---------|------|
| 体积 (VOLUME) | 1位小数 | 500.5 ml |
| 重量 (WEIGHT) | 0位小数 | 100 g |
| 计数 (COUNT) | 0位小数 | 5 个 |

### 7.4 常见问题

| 问题 | 原因 | 解决方案 |
|------|------|---------|
| 找不到辅助单位选项 | 未配置换算规则 | 先在单位换算管理中添加规则 |
| 库存数量不对 | 换算关系不一致 | 检查SKU和换算规则的配置 |
| BOM扣减精度丢失 | 主单位选择不当 | 使用最小计量单位作为主单位 |

---

## 八、相关文档

- [商品上架全流程配置指南](./商品上架全流程配置指南.md)
- [影院商品配置数据示例](./影院商品配置数据示例.md)

---

## 附录：常用原料单位换算参考

| 原料类型 | 源单位 | 目标单位 | 换算率 | 备注 |
|---------|--------|----------|--------|------|
| 烈酒 | 瓶(750ml) | ml | 750 | 标准酒瓶 |
| 烈酒 | 瓶(500ml) | ml | 500 | 小瓶装 |
| 啤酒 | 瓶 | ml | 330 | 标准啤酒瓶 |
| 啤酒 | 听 | ml | 330 | 易拉罐 |
| 果汁 | 盒 | ml | 1000 | 利乐包 |
| 糖浆 | 瓶 | ml | 750 | 标准糖浆瓶 |
| 咖啡豆 | 袋 | g | 1000 | 1kg装 |
| 牛奶 | 盒 | ml | 1000 | 1L装 |
| 冰淇淋 | 桶 | g | 5000 | 5kg桶装 |

---

*文档结束*
