# ops-expert å¢å¼ºæ–¹æ¡ˆï¼šå°ç¨‹åºå•†å“ä¸Šä¸‹æ¶è‡ªåŠ¨åŒ–

> **ç‰ˆæœ¬**: v1.0
> **çŠ¶æ€**: å¾…ç¡®è®¤
> **æœ€åæ›´æ–°**: 2026-01-05

---

## ä¸€ã€éœ€æ±‚æ¦‚è¿°

### 1.1 èƒŒæ™¯
è¿è¥äººå‘˜éœ€è¦é€šè¿‡é£ä¹¦å¤šç»´è¡¨æ ¼ç®¡ç†å°ç¨‹åºå•†å“æ•°æ®ï¼Œå¹¶è‡ªåŠ¨åŒæ­¥åˆ°ç³»ç»Ÿå®ç°å•†å“ä¸Šæ¶/ä¸‹æ¶ã€‚

### 1.2 ç›®æ ‡
1. åœ¨é£ä¹¦ä¸­åˆ›å»ºå•†å“ç®¡ç†è¡¨
2. è¯»å–é£ä¹¦è¡¨æ ¼æ•°æ®ï¼Œè°ƒç”¨ç³»ç»Ÿ API å®ç°å•†å“è‡ªåŠ¨ä¸Šæ¶/ä¸‹æ¶
3. æä¾›æ‰¹é‡æ“ä½œå’ŒçŠ¶æ€åŒæ­¥èƒ½åŠ›

### 1.3 ç¡®è®¤çš„çº¦æŸæ¡ä»¶

| é¡¹ç›® | ç¡®è®¤å†…å®¹ |
|------|----------|
| é£ä¹¦è¡¨æ ¼ | éœ€è¦è‡ªè¡Œåˆ›å»º |
| ä»·æ ¼å•ä½ | é£ä¹¦è¡¨ä¸­ä½¿ç”¨**å…ƒ**ï¼ŒAPI éœ€è¦**åˆ†** |
| SKU å…³è” | é€šè¿‡**åç§°**æŸ¥è¯¢å…³è” |
| API è®¤è¯ | **æš‚æ— è®¤è¯**ï¼Œç›´æ¥è°ƒç”¨ |
| è§¦å‘æ–¹å¼ | **æ‰‹åŠ¨è§¦å‘** |
| å†²çªç­–ç•¥ | **ä»¥é£ä¹¦ä¸ºå‡†** |

---

## äºŒã€ç³»ç»Ÿæ¶æ„

### 2.1 æ•´ä½“æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é£ä¹¦å¤šç»´è¡¨æ ¼   â”‚ â”€â”€â”€â”€ â”‚   ops-expert    â”‚ â”€â”€â”€â”€ â”‚   åç«¯ API      â”‚
â”‚  (å•†å“ç®¡ç†è¡¨)    â”‚      â”‚   (è„šæœ¬æ‰§è¡Œ)     â”‚      â”‚  (å•†å“æœåŠ¡)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                        â”‚                        â”‚
        â”‚  1. è¯»å–å¾…åŒæ­¥è®°å½•      â”‚                        â”‚
        â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
        â”‚                        â”‚                        â”‚
        â”‚                        â”‚  2. æŸ¥è¯¢SKU/åˆ†ç±»ID      â”‚
        â”‚                        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
        â”‚                        â”‚                        â”‚
        â”‚                        â”‚  3. åˆ›å»º/æ›´æ–°/æ”¹çŠ¶æ€    â”‚
        â”‚                        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
        â”‚                        â”‚                        â”‚
        â”‚  4. å›å†™åŒæ­¥ç»“æœ        â”‚                        â”‚
        â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
        â”‚                        â”‚                        â”‚
```

### 2.2 æ•°æ®æµå‘

```
é£ä¹¦è¡¨æ ¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º åç«¯ç³»ç»Ÿ
   â”‚                                                      â”‚
   â”‚  å•†å“åç§° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º displayName     â”‚
   â”‚  SKUåç§° â”€â”€â–º æŸ¥è¯¢SKU â”€â”€â–º skuId â”€â”€â”€â–º skuId           â”‚
   â”‚  åˆ†ç±»åç§° â”€â”€â–º æŸ¥è¯¢åˆ†ç±» â”€â–º categoryId â–º categoryId    â”‚
   â”‚  æ¸ é“ä»·æ ¼(å…ƒ) â”€â”€â–º Ã—100 â”€â”€â–º channelPrice(åˆ†)          â”‚
   â”‚  ä¸»å›¾URL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º mainImage       â”‚
   â”‚  æ˜¯å¦æ¨è â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º isRecommended   â”‚
   â”‚  æ’åºæƒé‡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º sortOrder       â”‚
   â”‚  ç›®æ ‡çŠ¶æ€ â”€â”€â–º æ˜ å°„ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º status           â”‚
   â”‚                                                      â”‚
   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚  ç³»ç»Ÿå•†å“ID â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ id               â”‚
   â”‚  åŒæ­¥çŠ¶æ€ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ“ä½œç»“æœ          â”‚
   â”‚  åŒæ­¥æ—¶é—´ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ—¶é—´æˆ³            â”‚
   â”‚  é”™è¯¯ä¿¡æ¯ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ é”™è¯¯è¯¦æƒ…          â”‚
```

---

## ä¸‰ã€é£ä¹¦è¡¨æ ¼è®¾è®¡

### 3.1 å•†å“ç®¡ç†è¡¨ç»“æ„

å°†åˆ›å»ºä¸€ä¸ªæ–°çš„å¤šç»´è¡¨æ ¼ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µå | å­—æ®µç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|----------|------|------|
| å•†å“åç§° | æ–‡æœ¬ | âœ“ | å°ç¨‹åºå±•ç¤ºåç§° |
| SKUåç§° | æ–‡æœ¬ | âœ“ | ç”¨äºæŸ¥è¯¢å…³è”çš„ SKU |
| åˆ†ç±»åç§° | å•é€‰ | âœ“ | èœå•åˆ†ç±»ï¼Œç”¨äºæŸ¥è¯¢ categoryId |
| æ¸ é“ä»·æ ¼ | æ•°å­— | âœ“ | å”®ä»·ï¼ˆå•ä½ï¼šå…ƒï¼‰ |
| ä¸»å›¾URL | æ–‡æœ¬ | | å•†å“ä¸»å›¾é“¾æ¥ |
| è¯¦æƒ…å›¾URL | æ–‡æœ¬ | | å¤šä¸ª URL ç”¨æ¢è¡Œåˆ†éš” |
| å•†å“æè¿° | å¤šè¡Œæ–‡æœ¬ | | å•†å“è¯¦ç»†æè¿° |
| è§„æ ¼è¯´æ˜ | æ–‡æœ¬ | | å•†å“è§„æ ¼ |
| æ˜¯å¦æ¨è | å¤é€‰æ¡† | | æ˜¯å¦é¦–é¡µæ¨è |
| æ’åºæƒé‡ | æ•°å­— | | æ˜¾ç¤ºé¡ºåºï¼Œæ•°å­—è¶Šå°è¶Šé å‰ |
| ç›®æ ‡çŠ¶æ€ | å•é€‰ | âœ“ | é€‰é¡¹ï¼šè‰ç¨¿/ä¸Šæ¶/ä¸‹æ¶ |
| ç³»ç»Ÿå•†å“ID | æ–‡æœ¬ | | åŒæ­¥åè‡ªåŠ¨å¡«å…… |
| åŒæ­¥çŠ¶æ€ | å•é€‰ | | é€‰é¡¹ï¼šå¾…åŒæ­¥/å·²åŒæ­¥/å¤±è´¥ |
| åŒæ­¥æ—¶é—´ | æ—¥æœŸæ—¶é—´ | | æœ€ååŒæ­¥æ—¶é—´ |
| é”™è¯¯ä¿¡æ¯ | æ–‡æœ¬ | | åŒæ­¥å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯ |

### 3.2 åˆ†ç±»é€‰é¡¹é…ç½®

åˆ†ç±»åç§°å­—æ®µçš„é€‰é¡¹éœ€ä¸ç³»ç»Ÿä¸­çš„èœå•åˆ†ç±»ä¸€è‡´ï¼Œä¾‹å¦‚ï¼š
- å…¨éƒ¨
- ç²¾å“å’–å•¡
- ç‰¹è°ƒé¥®å“
- ç”œç‚¹è›‹ç³•
- è½»é£Ÿç®€é¤

### 3.3 çŠ¶æ€æ˜ å°„è§„åˆ™

| é£ä¹¦"ç›®æ ‡çŠ¶æ€" | API status | è¯´æ˜ |
|----------------|------------|------|
| è‰ç¨¿ | DRAFT | åˆ›å»ºä½†ä¸ä¸Šæ¶ |
| ä¸Šæ¶ | ACTIVE | å°ç¨‹åºå¯è§ |
| ä¸‹æ¶ | INACTIVE | å°ç¨‹åºä¸å¯è§ |

---

## å››ã€åç«¯ API è¯´æ˜

### 4.1 ä½¿ç”¨çš„ API æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | ç”¨é€” |
|------|------|------|------|
| æŸ¥è¯¢ SKU | GET | `/api/skus?name={name}` | é€šè¿‡åç§°æŸ¥è¯¢ SKU ID |
| æŸ¥è¯¢åˆ†ç±» | GET | `/api/menu-categories?name={name}` | é€šè¿‡åç§°æŸ¥è¯¢åˆ†ç±» ID |
| åˆ›å»ºå•†å“ | POST | `/api/channel-products` | æ–°å»ºæ¸ é“å•†å“ |
| æ›´æ–°å•†å“ | PUT | `/api/channel-products/{id}` | æ›´æ–°å•†å“ä¿¡æ¯ |
| ä¿®æ”¹çŠ¶æ€ | PATCH | `/api/channel-products/{id}/status` | ä¸Šæ¶/ä¸‹æ¶ |
| æŸ¥è¯¢å•†å“ | GET | `/api/channel-products` | è·å–å•†å“åˆ—è¡¨ |

### 4.2 åˆ›å»ºå•†å“è¯·æ±‚ä½“

```json
{
  "skuId": "sku-uuid-xxx",
  "categoryId": "category-uuid-xxx",
  "displayName": "æ‹¿é“å’–å•¡",
  "channelPrice": 2800,
  "mainImage": "https://xxx/image.jpg",
  "detailImages": ["https://xxx/detail1.jpg"],
  "description": "é†‡é¦™æ‹¿é“",
  "specs": "ä¸­æ¯ 350ml",
  "isRecommended": true,
  "status": "ACTIVE",
  "sortOrder": 10
}
```

### 4.3 ä¿®æ”¹çŠ¶æ€è¯·æ±‚ä½“

```json
{
  "status": "ACTIVE"
}
```

### 4.4 API åŸºç¡€é…ç½®

```
BACKEND_API_BASE_URL=http://localhost:8080
```

ç”±äºæš‚æ— è®¤è¯ï¼Œè„šæœ¬ç›´æ¥è°ƒç”¨ API å³å¯ã€‚

---

## äº”ã€æ–°å¢èƒ½åŠ›è¯¦ç»†è®¾è®¡

### 5.1 èƒ½åŠ›ä¸€è§ˆ

| èƒ½åŠ› | å‘½ä»¤ç¤ºä¾‹ | è¯´æ˜ |
|------|----------|------|
| åˆ›å»ºå•†å“è¡¨ | "åˆ›å»ºå°ç¨‹åºå•†å“ç®¡ç†è¡¨" | åœ¨é£ä¹¦åˆ›å»ºè¡¨æ ¼ |
| åŒæ­¥å•†å“ | "åŒæ­¥é£ä¹¦å•†å“è¡¨" | æ‰¹é‡åˆ›å»º/æ›´æ–°å•†å“ |
| æ‰¹é‡ä¸Šæ¶ | "ä¸Šæ¶é£ä¹¦è¡¨ä¸­çš„å¾…ä¸Šæ¶å•†å“" | æ‰¹é‡æ”¹ä¸º ACTIVE |
| æ‰¹é‡ä¸‹æ¶ | "ä¸‹æ¶é£ä¹¦è¡¨ä¸­çš„å¾…ä¸‹æ¶å•†å“" | æ‰¹é‡æ”¹ä¸º INACTIVE |
| æŸ¥çœ‹çŠ¶æ€ | "æŸ¥çœ‹å•†å“åŒæ­¥çŠ¶æ€" | æ˜¾ç¤ºåŒæ­¥ç»Ÿè®¡ |
| å•å“ä¸Šæ¶ | "ä¸Šæ¶å•†å“'æ‹¿é“å’–å•¡'" | å•ä¸ªå•†å“æ“ä½œ |
| å•å“ä¸‹æ¶ | "ä¸‹æ¶å•†å“'æ‹¿é“å’–å•¡'" | å•ä¸ªå•†å“æ“ä½œ |

### 5.2 èƒ½åŠ›è¯¦ç»†è¯´æ˜

#### 5.2.1 åˆ›å»ºå•†å“è¡¨

**è§¦å‘è¯**: åˆ›å»ºå•†å“è¡¨ã€åˆ›å»ºå°ç¨‹åºå•†å“ç®¡ç†è¡¨ã€åˆå§‹åŒ–å•†å“è¡¨

**æ‰§è¡Œæµç¨‹**:
1. è°ƒç”¨é£ä¹¦ API åˆ›å»ºæ–°çš„å¤šç»´è¡¨æ ¼
2. æŒ‰è®¾è®¡åˆ›å»ºæ‰€æœ‰å­—æ®µ
3. é…ç½®åˆ†ç±»é€‰é¡¹ï¼ˆä»ç³»ç»ŸæŸ¥è¯¢ç°æœ‰åˆ†ç±»ï¼‰
4. è¿”å›è¡¨æ ¼é“¾æ¥

**è¾“å‡ºç¤ºä¾‹**:
```
âœ… å•†å“ç®¡ç†è¡¨åˆ›å»ºæˆåŠŸ

è¡¨æ ¼ä¿¡æ¯:
- App Token: xxx
- Table ID: xxx
- é“¾æ¥: https://xxx.feishu.cn/base/xxx

å·²åˆ›å»ºå­—æ®µ: 15 ä¸ª
å·²é…ç½®åˆ†ç±»é€‰é¡¹: 5 ä¸ª (å…¨éƒ¨ã€ç²¾å“å’–å•¡ã€ç‰¹è°ƒé¥®å“ã€ç”œç‚¹è›‹ç³•ã€è½»é£Ÿç®€é¤)

ä¸‹ä¸€æ­¥:
1. åœ¨è¡¨æ ¼ä¸­æ·»åŠ å•†å“æ•°æ®
2. è®¾ç½®"åŒæ­¥çŠ¶æ€"ä¸º"å¾…åŒæ­¥"
3. æ‰§è¡Œ"åŒæ­¥é£ä¹¦å•†å“è¡¨"å‘½ä»¤
```

#### 5.2.2 åŒæ­¥å•†å“

**è§¦å‘è¯**: åŒæ­¥å•†å“ã€åŒæ­¥é£ä¹¦å•†å“è¡¨ã€åŒæ­¥å•†å“æ•°æ®

**æ‰§è¡Œæµç¨‹**:
1. è¯»å–é£ä¹¦è¡¨ä¸­"åŒæ­¥çŠ¶æ€=å¾…åŒæ­¥"çš„è®°å½•
2. å¯¹æ¯æ¡è®°å½•ï¼š
   - é€šè¿‡ SKU åç§°æŸ¥è¯¢ skuId
   - é€šè¿‡åˆ†ç±»åç§°æŸ¥è¯¢ categoryId
   - ä»·æ ¼ä»å…ƒè½¬æ¢ä¸ºåˆ† (Ã—100)
   - å¦‚æ— ç³»ç»Ÿå•†å“ID â†’ åˆ›å»ºå•†å“
   - å¦‚æœ‰ç³»ç»Ÿå•†å“ID â†’ æ›´æ–°å•†å“
3. å›å†™ç»“æœåˆ°é£ä¹¦è¡¨

**è¾“å‡ºç¤ºä¾‹**:
```
ğŸ”„ å¼€å§‹åŒæ­¥å•†å“...

è¯»å–åˆ° 5 æ¡å¾…åŒæ­¥è®°å½•

å¤„ç†ä¸­:
  âœ… æ‹¿é“å’–å•¡ - åˆ›å»ºæˆåŠŸ (ID: xxx)
  âœ… ç¾å¼å’–å•¡ - åˆ›å»ºæˆåŠŸ (ID: xxx)
  âœ… å¡å¸ƒå¥‡è¯º - æ›´æ–°æˆåŠŸ
  âŒ æŠ¹èŒ¶æ‹¿é“ - å¤±è´¥: SKU "æŠ¹èŒ¶æ‹¿é“åŸæ–™" ä¸å­˜åœ¨
  âœ… ç„¦ç³–ç›å¥‡æœµ - åˆ›å»ºæˆåŠŸ (ID: xxx)

åŒæ­¥å®Œæˆ:
- æˆåŠŸ: 4 æ¡
- å¤±è´¥: 1 æ¡

å¤±è´¥è®°å½•å·²åœ¨é£ä¹¦è¡¨ä¸­æ ‡è®°ï¼Œè¯·æ£€æŸ¥"é”™è¯¯ä¿¡æ¯"åˆ—
```

#### 5.2.3 æ‰¹é‡ä¸Šæ¶/ä¸‹æ¶

**è§¦å‘è¯**:
- ä¸Šæ¶: æ‰¹é‡ä¸Šæ¶ã€ä¸Šæ¶å¾…ä¸Šæ¶å•†å“ã€æ‰§è¡Œä¸Šæ¶
- ä¸‹æ¶: æ‰¹é‡ä¸‹æ¶ã€ä¸‹æ¶å¾…ä¸‹æ¶å•†å“ã€æ‰§è¡Œä¸‹æ¶

**æ‰§è¡Œæµç¨‹**:
1. è¯»å–é£ä¹¦è¡¨ä¸­"ç›®æ ‡çŠ¶æ€=ä¸Šæ¶/ä¸‹æ¶"ä¸”"åŒæ­¥çŠ¶æ€=å·²åŒæ­¥"çš„è®°å½•
2. å¯¹æ¯æ¡è®°å½•è°ƒç”¨çŠ¶æ€ä¿®æ”¹ API
3. æ›´æ–°é£ä¹¦è¡¨ä¸­çš„åŒæ­¥æ—¶é—´

**è¾“å‡ºç¤ºä¾‹**:
```
ğŸ“¦ æ‰¹é‡ä¸Šæ¶å•†å“...

æ‰¾åˆ° 3 æ¡å¾…ä¸Šæ¶å•†å“

å¤„ç†ä¸­:
  âœ… æ‹¿é“å’–å•¡ - ä¸Šæ¶æˆåŠŸ
  âœ… ç¾å¼å’–å•¡ - ä¸Šæ¶æˆåŠŸ
  âŒ å¡å¸ƒå¥‡è¯º - å¤±è´¥: å•†å“ä¿¡æ¯ä¸å®Œæ•´ï¼Œæ— æ³•ä¸Šæ¶

ä¸Šæ¶å®Œæˆ:
- æˆåŠŸ: 2 æ¡
- å¤±è´¥: 1 æ¡
```

#### 5.2.4 æŸ¥çœ‹åŒæ­¥çŠ¶æ€

**è§¦å‘è¯**: æŸ¥çœ‹åŒæ­¥çŠ¶æ€ã€å•†å“åŒæ­¥ç»Ÿè®¡ã€åŒæ­¥æƒ…å†µ

**è¾“å‡ºç¤ºä¾‹**:
```
ğŸ“Š å•†å“åŒæ­¥çŠ¶æ€ç»Ÿè®¡

é£ä¹¦è¡¨æ ¼æ•°æ®:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ åŒæ­¥çŠ¶æ€  â”‚ æ•°é‡ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¾…åŒæ­¥    â”‚  3   â”‚
â”‚ å·²åŒæ­¥    â”‚ 12   â”‚
â”‚ å¤±è´¥      â”‚  1   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ€»è®¡      â”‚ 16   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

ç³»ç»Ÿå•†å“çŠ¶æ€:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ å•†å“çŠ¶æ€  â”‚ æ•°é‡ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚ è‰ç¨¿      â”‚  2   â”‚
â”‚ ä¸Šæ¶ä¸­    â”‚  8   â”‚
â”‚ å·²ä¸‹æ¶    â”‚  2   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ€»è®¡      â”‚ 12   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

å¾…å¤„ç†:
- 3 æ¡è®°å½•å¾…åŒæ­¥
- 1 æ¡åŒæ­¥å¤±è´¥éœ€å¤„ç†
```

#### 5.2.5 å•å“æ“ä½œ

**è§¦å‘è¯**:
- "ä¸Šæ¶å•†å“'xxx'"
- "ä¸‹æ¶å•†å“'xxx'"

**æ‰§è¡Œæµç¨‹**:
1. åœ¨é£ä¹¦è¡¨ä¸­æŸ¥æ‰¾è¯¥å•†å“
2. è·å–ç³»ç»Ÿå•†å“ID
3. è°ƒç”¨çŠ¶æ€ä¿®æ”¹ API
4. æ›´æ–°é£ä¹¦è¡¨

---

## å…­ã€è„šæœ¬è®¾è®¡

### 6.1 è„šæœ¬ç›®å½•ç»“æ„

```
.claude/skills/ops-expert/scripts/
â”œâ”€â”€ channel_product/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py              # é…ç½®ï¼ˆAPIåœ°å€ã€è¡¨æ ¼IDç­‰ï¼‰
â”‚   â”œâ”€â”€ api_client.py          # åç«¯ API å°è£…
â”‚   â”œâ”€â”€ feishu_helper.py       # é£ä¹¦è¡¨æ ¼æ“ä½œå°è£…
â”‚   â”œâ”€â”€ create_table.py        # åˆ›å»ºå•†å“ç®¡ç†è¡¨
â”‚   â”œâ”€â”€ sync_products.py       # åŒæ­¥å•†å“
â”‚   â”œâ”€â”€ batch_update_status.py # æ‰¹é‡ä¸Šæ¶/ä¸‹æ¶
â”‚   â”œâ”€â”€ update_single_status.py# å•å“çŠ¶æ€å˜æ›´
â”‚   â””â”€â”€ query_status.py        # æŸ¥è¯¢åŒæ­¥çŠ¶æ€
â””â”€â”€ common/
    â””â”€â”€ utils.py               # é€šç”¨å·¥å…·å‡½æ•°
```

### 6.2 æ ¸å¿ƒè„šæœ¬è¯´æ˜

#### config.py
```python
# åç«¯ API é…ç½®
BACKEND_API_BASE_URL = "http://localhost:8080"

# é£ä¹¦è¡¨æ ¼é…ç½®ï¼ˆåˆ›å»ºè¡¨åæ›´æ–°ï¼‰
FEISHU_APP_TOKEN = ""  # åˆ›å»ºè¡¨åå¡«å…¥
FEISHU_TABLE_ID = ""   # åˆ›å»ºè¡¨åå¡«å…¥

# å­—æ®µæ˜ å°„
FIELD_MAPPING = {
    "å•†å“åç§°": "displayName",
    "SKUåç§°": "_sku_name",      # ç”¨äºæŸ¥è¯¢
    "åˆ†ç±»åç§°": "_category_name", # ç”¨äºæŸ¥è¯¢
    "æ¸ é“ä»·æ ¼": "channelPrice",   # éœ€è¦ Ã—100
    "ä¸»å›¾URL": "mainImage",
    "è¯¦æƒ…å›¾URL": "detailImages",  # éœ€è¦åˆ†å‰²
    "å•†å“æè¿°": "description",
    "è§„æ ¼è¯´æ˜": "specs",
    "æ˜¯å¦æ¨è": "isRecommended",
    "æ’åºæƒé‡": "sortOrder",
    "ç›®æ ‡çŠ¶æ€": "_target_status",
    "ç³»ç»Ÿå•†å“ID": "_system_id",
    "åŒæ­¥çŠ¶æ€": "_sync_status",
}

# çŠ¶æ€æ˜ å°„
STATUS_MAPPING = {
    "è‰ç¨¿": "DRAFT",
    "ä¸Šæ¶": "ACTIVE",
    "ä¸‹æ¶": "INACTIVE",
}
```

#### api_client.py
```python
"""åç«¯ API å®¢æˆ·ç«¯"""
import requests
from config import BACKEND_API_BASE_URL

class ChannelProductAPI:
    def __init__(self):
        self.base_url = BACKEND_API_BASE_URL

    def find_sku_by_name(self, name: str) -> dict:
        """é€šè¿‡åç§°æŸ¥è¯¢ SKU"""
        resp = requests.get(f"{self.base_url}/api/skus", params={"name": name})
        resp.raise_for_status()
        data = resp.json().get("data", [])
        if not data:
            raise ValueError(f"SKU '{name}' ä¸å­˜åœ¨")
        return data[0]

    def find_category_by_name(self, name: str) -> dict:
        """é€šè¿‡åç§°æŸ¥è¯¢åˆ†ç±»"""
        resp = requests.get(f"{self.base_url}/api/menu-categories", params={"name": name})
        resp.raise_for_status()
        data = resp.json().get("data", [])
        if not data:
            raise ValueError(f"åˆ†ç±» '{name}' ä¸å­˜åœ¨")
        return data[0]

    def create_product(self, data: dict) -> dict:
        """åˆ›å»ºå•†å“"""
        resp = requests.post(f"{self.base_url}/api/channel-products", json=data)
        resp.raise_for_status()
        return resp.json()

    def update_product(self, product_id: str, data: dict) -> dict:
        """æ›´æ–°å•†å“"""
        resp = requests.put(f"{self.base_url}/api/channel-products/{product_id}", json=data)
        resp.raise_for_status()
        return resp.json()

    def update_status(self, product_id: str, status: str) -> dict:
        """ä¿®æ”¹å•†å“çŠ¶æ€"""
        resp = requests.patch(
            f"{self.base_url}/api/channel-products/{product_id}/status",
            json={"status": status}
        )
        resp.raise_for_status()
        return resp.json()
```

#### sync_products.py
```python
#!/usr/bin/env python3
"""åŒæ­¥é£ä¹¦å•†å“è¡¨åˆ°ç³»ç»Ÿ"""
import argparse
from datetime import datetime
from api_client import ChannelProductAPI
from feishu_helper import FeishuHelper
from config import FEISHU_APP_TOKEN, FEISHU_TABLE_ID, STATUS_MAPPING

def sync_products(dry_run: bool = False):
    """
    åŒæ­¥æµç¨‹:
    1. è¯»å–é£ä¹¦è¡¨ä¸­"åŒæ­¥çŠ¶æ€=å¾…åŒæ­¥"çš„è®°å½•
    2. æ•°æ®è½¬æ¢ï¼ˆæŸ¥è¯¢IDã€ä»·æ ¼è½¬æ¢ï¼‰
    3. åˆ›å»ºæˆ–æ›´æ–°å•†å“
    4. å›å†™ç»“æœåˆ°é£ä¹¦è¡¨
    """
    api = ChannelProductAPI()
    feishu = FeishuHelper(FEISHU_APP_TOKEN, FEISHU_TABLE_ID)

    # è¯»å–å¾…åŒæ­¥è®°å½•
    records = feishu.search_records(filter_condition={
        "field_name": "åŒæ­¥çŠ¶æ€",
        "operator": "is",
        "value": ["å¾…åŒæ­¥"]
    })

    print(f"è¯»å–åˆ° {len(records)} æ¡å¾…åŒæ­¥è®°å½•\n")

    results = {"success": [], "failed": []}

    for record in records:
        fields = record["fields"]
        product_name = fields.get("å•†å“åç§°", "æœªçŸ¥")

        try:
            # 1. æŸ¥è¯¢ SKU ID
            sku_name = fields.get("SKUåç§°")
            sku = api.find_sku_by_name(sku_name)
            sku_id = sku["id"]

            # 2. æŸ¥è¯¢åˆ†ç±» ID
            category_name = fields.get("åˆ†ç±»åç§°")
            category = api.find_category_by_name(category_name)
            category_id = category["id"]

            # 3. æ„å»ºè¯·æ±‚æ•°æ®
            price_yuan = fields.get("æ¸ é“ä»·æ ¼", 0)
            price_fen = int(float(price_yuan) * 100)

            product_data = {
                "skuId": sku_id,
                "categoryId": category_id,
                "displayName": fields.get("å•†å“åç§°"),
                "channelPrice": price_fen,
                "mainImage": fields.get("ä¸»å›¾URL"),
                "description": fields.get("å•†å“æè¿°"),
                "specs": fields.get("è§„æ ¼è¯´æ˜"),
                "isRecommended": fields.get("æ˜¯å¦æ¨è", False),
                "sortOrder": fields.get("æ’åºæƒé‡", 0),
                "status": STATUS_MAPPING.get(fields.get("ç›®æ ‡çŠ¶æ€"), "DRAFT"),
            }

            # å¤„ç†è¯¦æƒ…å›¾
            detail_images = fields.get("è¯¦æƒ…å›¾URL", "")
            if detail_images:
                product_data["detailImages"] = detail_images.split("\n")

            if dry_run:
                print(f"  [DRY-RUN] {product_name} - å°†åˆ›å»º/æ›´æ–°")
                continue

            # 4. åˆ›å»ºæˆ–æ›´æ–°
            system_id = fields.get("ç³»ç»Ÿå•†å“ID")
            if system_id:
                api.update_product(system_id, product_data)
                print(f"  âœ… {product_name} - æ›´æ–°æˆåŠŸ")
            else:
                result = api.create_product(product_data)
                system_id = result["data"]["id"]
                print(f"  âœ… {product_name} - åˆ›å»ºæˆåŠŸ (ID: {system_id})")

            # 5. å›å†™æˆåŠŸçŠ¶æ€
            feishu.update_record(record["record_id"], {
                "ç³»ç»Ÿå•†å“ID": system_id,
                "åŒæ­¥çŠ¶æ€": "å·²åŒæ­¥",
                "åŒæ­¥æ—¶é—´": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                "é”™è¯¯ä¿¡æ¯": "",
            })
            results["success"].append(product_name)

        except Exception as e:
            error_msg = str(e)
            print(f"  âŒ {product_name} - å¤±è´¥: {error_msg}")

            # å›å†™å¤±è´¥çŠ¶æ€
            if not dry_run:
                feishu.update_record(record["record_id"], {
                    "åŒæ­¥çŠ¶æ€": "å¤±è´¥",
                    "é”™è¯¯ä¿¡æ¯": error_msg,
                })
            results["failed"].append({"name": product_name, "error": error_msg})

    # è¾“å‡ºæ±‡æ€»
    print(f"\nåŒæ­¥å®Œæˆ:")
    print(f"- æˆåŠŸ: {len(results['success'])} æ¡")
    print(f"- å¤±è´¥: {len(results['failed'])} æ¡")

    return results

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--dry-run", action="store_true", help="è¯•è¿è¡Œï¼Œä¸å®é™…æ‰§è¡Œ")
    args = parser.parse_args()
    sync_products(dry_run=args.dry_run)
```

---

## ä¸ƒã€SKILL.md ä¿®æ”¹å†…å®¹

### 7.1 description æ›´æ–°

```yaml
description: å½±é™¢å•†å“ç®¡ç†ä¸­å°è¿è¥ä¸“å®¶ã€‚å½“ç”¨æˆ·éœ€è¦ä»¥ä¸‹æ“ä½œæ—¶ä½¿ç”¨æ­¤skillï¼š
(1) æŸ¥è¯¢åœºæ™¯åŒ…ã€é—¨åº—ã€å½±å…ã€é¢„çº¦ã€å•ä½æ¢ç®—ç­‰æ•°æ®ï¼›
(2) æ‰§è¡Œåœºæ™¯åŒ…å‘å¸ƒ/ä¸‹æ¶ã€é—¨åº—è®¾ç½®ä¿®æ”¹ã€å•ä½æ¢ç®—é…ç½®ç­‰æ“ä½œï¼›
(3) è·å–ç³»ç»Ÿæ“ä½œæŒ‡å¯¼å’Œä¸šåŠ¡è§„åˆ™è¯´æ˜ï¼›
(4) å•ä½æ¢ç®—è®¡ç®—å’Œæ¢ç®—è§„åˆ™ç®¡ç†ï¼›
(5) å°ç¨‹åºå•†å“ä¸Šæ¶ã€ä¸‹æ¶ã€åŒæ­¥ç®¡ç†ã€‚
è§¦å‘è¯ï¼š...å•†å“ä¸Šæ¶ã€å•†å“ä¸‹æ¶ã€åŒæ­¥å•†å“ã€é£ä¹¦å•†å“è¡¨ã€å°ç¨‹åºå•†å“ã€æ¸ é“å•†å“ã€åˆ›å»ºå•†å“è¡¨ã€‚
```

### 7.2 æ–°å¢æ ¸å¿ƒèƒ½åŠ›ç« èŠ‚

```markdown
### 5. å°ç¨‹åºå•†å“ç®¡ç† (Channel Product) - NEW

æä¾›å°ç¨‹åºå•†å“çš„ä¸Šæ¶ã€ä¸‹æ¶ã€åŒæ­¥èƒ½åŠ›ï¼Œä¸é£ä¹¦å¤šç»´è¡¨æ ¼é›†æˆï¼š

**æ ¸å¿ƒåŠŸèƒ½**:
- **åˆ›å»ºå•†å“è¡¨**: åœ¨é£ä¹¦åˆ›å»ºå•†å“ç®¡ç†å¤šç»´è¡¨æ ¼
- **åŒæ­¥å•†å“**: ä»é£ä¹¦è¡¨åŒæ­¥å•†å“æ•°æ®åˆ°ç³»ç»Ÿ
- **æ‰¹é‡ä¸Šæ¶**: æ‰¹é‡å°†å•†å“çŠ¶æ€æ”¹ä¸ºä¸Šæ¶
- **æ‰¹é‡ä¸‹æ¶**: æ‰¹é‡å°†å•†å“çŠ¶æ€æ”¹ä¸ºä¸‹æ¶
- **çŠ¶æ€æŸ¥è¯¢**: æŸ¥çœ‹åŒæ­¥çŠ¶æ€ç»Ÿè®¡
- **å•å“æ“ä½œ**: å¯¹å•ä¸ªå•†å“æ‰§è¡Œä¸Šæ¶/ä¸‹æ¶

**æ•°æ®æµå‘**: é£ä¹¦å¤šç»´è¡¨æ ¼ â†’ ç³»ç»Ÿ API â†’ å›å†™ç»“æœåˆ°é£ä¹¦

**è„šæœ¬ä½ç½®**: `.claude/skills/ops-expert/scripts/channel_product/`
```

### 7.3 æ–°å¢æ„å›¾è¯†åˆ«

```markdown
| æ„å›¾ç±»å‹ | å…³é”®è¯ç¤ºä¾‹ | æ‰§è¡Œè·¯å¾„ |
|---------|-----------|---------|
| å•†å“è¡¨åˆ›å»º | åˆ›å»ºå•†å“è¡¨ã€åˆå§‹åŒ–å•†å“è¡¨ | create_table.py |
| å•†å“åŒæ­¥ | åŒæ­¥å•†å“ã€åŒæ­¥é£ä¹¦å•†å“è¡¨ | sync_products.py |
| æ‰¹é‡ä¸Šæ¶ | æ‰¹é‡ä¸Šæ¶ã€ä¸Šæ¶å¾…ä¸Šæ¶å•†å“ | batch_update_status.py --status ACTIVE |
| æ‰¹é‡ä¸‹æ¶ | æ‰¹é‡ä¸‹æ¶ã€ä¸‹æ¶å¾…ä¸‹æ¶å•†å“ | batch_update_status.py --status INACTIVE |
| åŒæ­¥çŠ¶æ€ | æŸ¥çœ‹åŒæ­¥çŠ¶æ€ã€å•†å“åŒæ­¥ç»Ÿè®¡ | query_status.py |
| å•å“æ“ä½œ | ä¸Šæ¶å•†å“xxxã€ä¸‹æ¶å•†å“xxx | update_single_status.py |
```

### 7.4 æ–°å¢å¸¸è§æŒ‡ä»¤ç¤ºä¾‹

```markdown
### å•†å“ç®¡ç†ç±»
- "åˆ›å»ºå°ç¨‹åºå•†å“ç®¡ç†è¡¨"
- "åŒæ­¥é£ä¹¦å•†å“è¡¨"
- "ä¸Šæ¶é£ä¹¦è¡¨ä¸­çš„å¾…ä¸Šæ¶å•†å“"
- "ä¸‹æ¶å•†å“'æ‹¿é“å’–å•¡'"
- "æŸ¥çœ‹å•†å“åŒæ­¥çŠ¶æ€"
```

### 7.5 æ–°å¢å·¥å…·æƒé™

```markdown
- `mcp__lark-mcp__bitable_v1_app_create` - åˆ›å»ºé£ä¹¦å¤šç»´è¡¨æ ¼
- `mcp__lark-mcp__bitable_v1_appTable_create` - åˆ›å»ºè¡¨æ ¼
- `mcp__lark-mcp__bitable_v1_appTableField_list` - è·å–å­—æ®µåˆ—è¡¨
- `mcp__lark-mcp__bitable_v1_appTableRecord_search` - æœç´¢è®°å½•
- `mcp__lark-mcp__bitable_v1_appTableRecord_create` - åˆ›å»ºè®°å½•
- `mcp__lark-mcp__bitable_v1_appTableRecord_update` - æ›´æ–°è®°å½•
```

### 7.6 æ–°å¢é”™è¯¯ç 

```markdown
| é”™è¯¯åœºæ™¯ | é”™è¯¯ä»£ç  | å¤„ç†æ–¹å¼ |
|---------|---------|---------|
| SKU ä¸å­˜åœ¨ | `SKU_NOT_FOUND` | æ£€æŸ¥ SKU åç§°æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿ç³»ç»Ÿä¸­å·²åˆ›å»º |
| åˆ†ç±»ä¸å­˜åœ¨ | `CATEGORY_NOT_FOUND` | æ£€æŸ¥åˆ†ç±»åç§°æ˜¯å¦æ­£ç¡® |
| å•†å“å·²å­˜åœ¨ | `DUPLICATE_PRODUCT` | æ›´æ–°è€Œéåˆ›å»º |
| çŠ¶æ€å˜æ›´å¤±è´¥ | `STATUS_CHANGE_FAILED` | æ£€æŸ¥å•†å“å½“å‰çŠ¶æ€å’Œå¿…å¡«å­—æ®µ |
| é£ä¹¦ API é”™è¯¯ | `FEISHU_API_ERROR` | æ£€æŸ¥ç½‘ç»œå’Œæƒé™ |
```

---

## å…«ã€å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€è®¾æ–½
- [ ] åˆ›å»ºè„šæœ¬ç›®å½•ç»“æ„
- [ ] å®ç° config.py é…ç½®æ¨¡å—
- [ ] å®ç° api_client.py åç«¯ API å°è£…
- [ ] å®ç° feishu_helper.py é£ä¹¦æ“ä½œå°è£…

### Phase 2: æ ¸å¿ƒåŠŸèƒ½
- [ ] å®ç° create_table.py åˆ›å»ºå•†å“è¡¨
- [ ] å®ç° sync_products.py åŒæ­¥å•†å“
- [ ] å®ç° batch_update_status.py æ‰¹é‡æ“ä½œ
- [ ] å®ç° update_single_status.py å•å“æ“ä½œ
- [ ] å®ç° query_status.py çŠ¶æ€æŸ¥è¯¢

### Phase 3: é›†æˆæµ‹è¯•
- [ ] æµ‹è¯•åˆ›å»ºè¡¨æ ¼åŠŸèƒ½
- [ ] æµ‹è¯•å•†å“åŒæ­¥æµç¨‹
- [ ] æµ‹è¯•ä¸Šæ¶/ä¸‹æ¶æ“ä½œ
- [ ] æµ‹è¯•é”™è¯¯å¤„ç†

### Phase 4: æ–‡æ¡£æ›´æ–°
- [ ] æ›´æ–° SKILL.md
- [ ] æ·»åŠ  references/channel-product.md æ“ä½œæŒ‡å—
- [ ] æ·»åŠ  examples/channel-product-examples.md ç¤ºä¾‹

---

## ä¹ã€é£é™©ä¸æ³¨æ„äº‹é¡¹

### 9.1 æ•°æ®ä¸€è‡´æ€§
- ä»¥é£ä¹¦ä¸ºå‡†ï¼Œç³»ç»Ÿæ•°æ®å¯èƒ½è¢«è¦†ç›–
- å»ºè®®åœ¨é£ä¹¦è¡¨ä¸­ä¿ç•™å˜æ›´å†å²

### 9.2 SKU/åˆ†ç±»ä¾èµ–
- SKU å’Œåˆ†ç±»å¿…é¡»å…ˆåœ¨ç³»ç»Ÿä¸­åˆ›å»º
- åŒæ­¥å‰éœ€ç¡®ä¿åç§°å®Œå…¨åŒ¹é…

### 9.3 ä»·æ ¼ç²¾åº¦
- é£ä¹¦ä½¿ç”¨å…ƒï¼ŒAPI ä½¿ç”¨åˆ†
- è½¬æ¢æ—¶ä½¿ç”¨ `int(float(price) * 100)` é¿å…ç²¾åº¦é—®é¢˜

### 9.4 å¹¶å‘æ“ä½œ
- åŒä¸€å•†å“é¿å…åŒæ—¶åœ¨é£ä¹¦å’Œç³»ç»Ÿä¸­ä¿®æ”¹
- ä»¥é£ä¹¦ä¸ºå‡†ï¼Œç³»ç»Ÿä¿®æ”¹ä¼šè¢«ä¸‹æ¬¡åŒæ­¥è¦†ç›–

---

## åã€ç¡®è®¤æ¸…å•

è¯·ç¡®è®¤ä»¥ä¸‹å†…å®¹åå¼€å§‹å¼€å‘ï¼š

- [ ] é£ä¹¦è¡¨æ ¼ç»“æ„è®¾è®¡æ˜¯å¦æ»¡è¶³éœ€æ±‚ï¼Ÿ
- [ ] å­—æ®µæ˜ å°„å…³ç³»æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] çŠ¶æ€æ˜ å°„è§„åˆ™æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] è„šæœ¬åŠŸèƒ½æ˜¯å¦è¦†ç›–æ‰€æœ‰éœ€æ±‚ï¼Ÿ
- [ ] é”™è¯¯å¤„ç†ç­–ç•¥æ˜¯å¦åˆç†ï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦å…¶ä»–åŠŸèƒ½ï¼Ÿ

---

**ç¡®è®¤åè¯·å›å¤"ç¡®è®¤å¼€å§‹å¼€å‘"ï¼Œæˆ‘å°†æŒ‰è®¡åˆ’å®æ–½ã€‚**
