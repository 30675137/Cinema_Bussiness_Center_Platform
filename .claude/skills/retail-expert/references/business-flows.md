# 零售/电商业务流程参考

## 目录
- [电商购物流程](#电商购物流程)
- [门店收银流程](#门店收银流程)
- [全渠道履约流程](#全渠道履约流程)
- [退货退款流程](#退货退款流程)
- [采购入库流程](#采购入库流程)
- [盘点流程](#盘点流程)

---

## 电商购物流程

### 完整流程图
```mermaid
graph TD
    A[浏览商品] --> B[加入购物车]
    B --> C[结算下单]
    C --> D{选择收货地址}
    D --> E[选择优惠券]
    E --> F[选择支付方式]
    F --> G[提交订单]
    G --> H{支付}
    H -->|成功| I[等待发货]
    H -->|失败/取消| J[订单关闭]
    I --> K[商家发货]
    K --> L[物流配送]
    L --> M[确认收货]
    M --> N[评价]
```

### 关键节点说明
1. **购物车**：支持多店铺、凑单优惠提示、库存校验
2. **下单结算**：地址校验、优惠计算、库存锁定
3. **支付**：支付超时自动关闭（通常15-30分钟）
4. **发货**：订单拆分（多仓、多物流）
5. **收货**：自动确认收货（通常7-15天）

---

## 门店收银流程

### POS收银流程
```mermaid
graph TD
    A[扫描商品条码] --> B[添加到购物清单]
    B --> C{是否继续添加}
    C -->|是| A
    C -->|否| D[确认商品清单]
    D --> E{会员识别}
    E -->|是| F[加载会员信息和优惠]
    E -->|否| G[散客结账]
    F --> H[应用优惠]
    G --> H
    H --> I[选择支付方式]
    I --> J{支付}
    J -->|成功| K[打印小票]
    J -->|失败| I
    K --> L[交易完成]
```

### 关键功能
1. **快速收银**：支持扫码枪、手工输入、称重商品
2. **会员识别**：手机号、会员卡、人脸识别
3. **多种支付**：现金、银行卡、微信、支付宝、组合支付
4. **小票管理**：电子小票、重打小票

---

## 全渠道履约流程

### 履约方式
1. **仓库发货**：电商标准模式，从中心仓或区域仓发货
2. **门店发货**：门店作为前置仓，就近发货
3. **门店自提**：线上下单，门店取货
4. **即时配送**：O2O模式，1小时达

### 订单路由逻辑
```mermaid
graph TD
    A[订单创建] --> B{判断履约方式}
    B -->|普通快递| C[选择发货仓]
    B -->|门店自提| D[锁定门店库存]
    B -->|即时配送| E[就近门店配送]
    C --> F{库存分配}
    F -->|单仓满足| G[单仓发货]
    F -->|需拆单| H[多仓发货]
    D --> I[等待取货]
    E --> J[门店拣货]
    J --> K[骑手配送]
```

### 库存分配原则
1. 距离最近原则
2. 成本最优原则
3. 时效优先原则
4. 库存均衡原则

---

## 退货退款流程

### 退款类型
- **仅退款**：未发货订单或虚拟商品
- **退货退款**：收到货后的退货
- **换货**：质量问题换同款
- **部分退款**：订单中部分商品退款

### 退货退款流程
```mermaid
graph TD
    A[申请退款] --> B{审核}
    B -->|通过| C{退款类型}
    B -->|拒绝| D[申请失败]
    C -->|仅退款| E[直接退款]
    C -->|退货退款| F[用户寄回商品]
    F --> G[商家收货验收]
    G --> H{验收结果}
    H -->|通过| E
    H -->|不通过| I[拒绝退款/协商]
    E --> J[退款到账]
```

### 退款资金流
```
原路退回：微信支付→微信零钱，支付宝→支付宝余额
退款时效：1-7个工作日（视支付渠道）
```

---

## 采购入库流程

### 采购流程
```mermaid
graph TD
    A[采购需求] --> B[创建采购单]
    B --> C[供应商确认]
    C --> D[供应商发货]
    D --> E[到货质检]
    E --> F{质检结果}
    F -->|合格| G[入库上架]
    F -->|不合格| H[退货/换货]
    G --> I[更新库存]
    I --> J[采购完成]
```

### 入库类型
1. **采购入库**：正常采购到货
2. **退货入库**：客户退货入库
3. **调拨入库**：仓间调拨
4. **盘盈入库**：盘点发现多余

---

## 盘点流程

### 盘点方式
1. **全盘**：盘点所有商品
2. **抽盘**：按品类/区域抽样盘点
3. **动态盘点**：持续性循环盘点

### 盘点流程
```mermaid
graph TD
    A[创建盘点任务] --> B[冻结库存]
    B --> C[实地盘点]
    C --> D[录入实盘数量]
    D --> E[系统比对]
    E --> F{是否有差异}
    F -->|是| G[差异审核]
    F -->|否| H[盘点完成]
    G --> I{审核结果}
    I -->|确认差异| J[库存调整]
    I -->|复盘| C
    J --> H
    H --> K[解冻库存]
```

### 差异处理
- **盘盈**：实盘>系统账，做盘盈入库
- **盘亏**：实盘<系统账，做盘亏出库，追查原因
