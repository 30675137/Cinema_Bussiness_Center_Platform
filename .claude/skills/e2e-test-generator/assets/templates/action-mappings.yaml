# @spec T002-e2e-test-generator
# Action Mappings Configuration
# Maps scenario action names to framework-specific code templates
#
# System Identifiers:
#   - c-end: C端（用户端）- Taro H5/小程序 (http://localhost:10086)
#   - b-end: B端（运营中台）- React Admin (http://localhost:3000)
#   - api: 纯 API 调用（无 UI 交互）
#
# Cross-System Testing:
#   - Actions with different 'system' values will trigger context switching
#   - First occurrence of 'b-end' will create new page: adminPage = await context.newPage()
#   - Subsequent 'b-end' actions will reuse the same adminPage

# Authentication Actions
login:
  playwright:
    code: "await loginPage.login(testData)"
    imports: ["LoginPage"]
    params: ["testdata_ref"]
  postman:
    method: POST
    url: "/api/auth/login"
    body: "{{testdata_ref}}"
    tests: |
      pm.test('Login successful', () => {
        pm.response.to.have.status(200);
        pm.environment.set('authToken', pm.response.json().token);
      });
  restclient:
    method: POST
    url: "/api/auth/login"
    body: "{{testdata_ref}}"
    expect: "HTTP/1.1 200 OK"

logout:
  playwright:
    code: "await loginPage.logout()"
    imports: ["LoginPage"]
    params: []

# Navigation Actions
navigate:
  playwright:
    code: "await page.goto(testData.{{testdata_ref}})"
    imports: []
    params: ["testdata_ref"]

click:
  playwright:
    code: "await page.click(testData.{{selector}})"
    imports: []
    params: ["selector"]

# Input Actions
input:
  playwright:
    code: "await page.fill(testData.{{selector}}, testData.{{value}})"
    imports: []
    params: ["selector", "value"]

select:
  playwright:
    code: "await page.selectOption(testData.{{selector}}, testData.{{value}})"
    imports: []
    params: ["selector", "value"]

upload_file:
  playwright:
    code: "await page.setInputFiles(testData.{{selector}}, testData.{{filepath}})"
    imports: []
    params: ["selector", "filepath"]

# Product/Inventory Actions
browse_product:
  playwright:
    code: "await productPage.browseProduct(testData.{{testdata_ref}})"
    imports: ["ProductPage"]
    params: ["testdata_ref"]

add_to_cart:
  playwright:
    code: "await cartPage.addToCart(testData.{{testdata_ref}}, {{quantity}})"
    imports: ["CartPage"]
    params: ["testdata_ref", "quantity"]

checkout:
  playwright:
    code: "await checkoutPage.proceed()"
    imports: ["CheckoutPage"]
    params: []

# Order Management Actions
create_order:
  playwright:
    code: "await orderPage.createOrder(testData.{{testdata_ref}})"
    imports: ["OrderPage"]
    params: ["testdata_ref"]
  postman:
    method: POST
    url: "/api/orders"
    body: "{{testdata_ref}}"
    tests: |
      pm.test('Order created', () => {
        pm.response.to.have.status(201);
        pm.environment.set('orderId', pm.response.json().data.orderId);
      });
  restclient:
    method: POST
    url: "/api/orders"
    body: "{{testdata_ref}}"
    expect: "HTTP/1.1 201 Created"

cancel_order:
  playwright:
    code: "await orderPage.cancelOrder(testData.{{orderId}})"
    imports: ["OrderPage"]
    params: ["orderId"]
  postman:
    method: DELETE
    url: "/api/orders/{{orderId}}"
    body: ""
    tests: |
      pm.test('Order cancelled', () => {
        pm.response.to.have.status(200);
      });

# Inventory Actions
create_adjustment:
  playwright:
    code: "await inventoryPage.createAdjustment(testData.{{testdata_ref}})"
    imports: ["InventoryPage"]
    params: ["testdata_ref"]

approve_adjustment:
  playwright:
    code: "await inventoryPage.approveAdjustment(testData.{{adjustmentId}})"
    imports: ["InventoryPage"]
    params: ["adjustmentId"]

query_inventory:
  playwright:
    code: "await inventoryPage.queryInventory(testData.{{testdata_ref}})"
    imports: ["InventoryPage"]
    params: ["testdata_ref"]
  postman:
    method: GET
    url: "/api/inventory?{{testdata_ref}}"
    body: ""
    tests: |
      pm.test('Inventory query successful', () => {
        pm.response.to.have.status(200);
        pm.test('Response has data', () => {
          pm.expect(pm.response.json().data).to.be.an('array');
        });
      });

# Wait Actions
wait:
  playwright:
    code: "await page.waitForTimeout({{duration}})"
    imports: []
    params: ["duration"]

wait_for_element:
  playwright:
    code: "await page.waitForSelector(testData.{{selector}}, { timeout: {{timeout}} })"
    imports: []
    params: ["selector", "timeout"]

# API Actions
send_api_request:
  playwright:
    code: "const response = await page.request.{{method}}(testData.{{url}}, { data: testData.{{body}} })"
    imports: []
    params: ["method", "url", "body"]
  postman:
    method: "{{method}}"
    url: "{{url}}"
    body: "{{body}}"
    tests: |
      pm.test('API request successful', () => {
        pm.response.to.have.status(200);
      });

# Database Actions (TODO: Implementation required)
query_database:
  playwright:
    code: "// TODO: Implement database query for {{query}}"
    imports: []
    params: ["query"]

verify_database:
  playwright:
    code: "// TODO: Implement database verification for {{table}}.{{field}}"
    imports: []
    params: ["table", "field"]
